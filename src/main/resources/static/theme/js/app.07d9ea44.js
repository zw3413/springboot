(function(e){function t(t){for(var n,o,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&h.push(r[o][0]),r[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(h.length)h.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],n=!0,s=1;s<i.length;s++){var l=i[s];0!==r[l]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},r={app:0},a=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"002b":function(e,t,i){"use strict";i("9945")},"00d6":function(e,t,i){"use strict";i("1e6b")},"06b2":function(e,t,i){"use strict";i("fe26")},"0bbc":function(e,t,i){},"1e6b":function(e,t,i){},"26a8":function(e,t,i){"use strict";i("3482")},3482:function(e,t,i){},"36e9":function(e,t,i){},"3a10":function(e,t,i){},"483a":function(e,t,i){},"4ab0":function(e,t,i){"use strict";var n=function(){function e(){}return e.MARKER=0,e.POINT=5,e.POLYLINE=1,e.POLYGON=2,e.LABEL=3,e.MODEL=4,e}();t["a"]=n},"4e00":function(e,t,i){"use strict";i("ac4d"),i("8a81"),i("1c4c"),i("7f7f"),i("6b54"),i("456d"),i("ac6a"),i("5df3"),i("f400");var n=i("d225"),r=i("b0b4"),a=i("cd53"),o=i("9944"),s=i("4ab0"),l=i("21a6");function c(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=d(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function d(e,t){if(e){if("string"===typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h=window.Cesium,p=h.defined,m=window.console,f=h.ScreenSpaceEventType.LEFT_CLICK,g=h.ScreenSpaceEventType.RIGHT_CLICK,v=h.ScreenSpaceEventType.MOUSE_MOVE,_=h.ScreenSpaceEventType.LEFT_DOWN,y=h.ScreenSpaceEventType.LEFT_UP,w=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Object(n["a"])(this,e),t instanceof h.Viewer===!1)throw new Error("viewer不是一个有效的Cesium Viewer");this.viewer=t,this.options=i,this._heightReference="CLAMP_TO_GROUND",this._material=void 0,this._style={},this.graphicId=void 0,this.handler=new h.ScreenSpaceEventHandler(this.viewer.canvas),this.graphicType=void 0,this.positions=[],this.tip=new o["e"].CursorTip(""),this.tip.visible=!1,this.mode="ready",this.dragging=!1,this.editManager=void 0,this.selectedNodeIndex=-1,this.manager=new Map;var r=this;document.onkeydown=function(e){if("edit"===r.mode){var t=e||window.event||arguments.callee.caller.arguments[0];if(t&&46==t.keyCode)if(r.selectedNodeIndex>-1&&r.editManager)r.editManager.dropNode(r.selectedNodeIndex),r.highlightedNode(void 0,r.editManager.nodeGraphic),r.selectedNodeIndex=-1;else if(r.editManager){r.editManager.destroy(),r.manager.delete(r.editManager.id),r.mode="end",r.tip.visible=!1;var i=new CustomEvent("deleteEvent",{detail:{gvid:r.editManager?r.editManager.gvid:void 0}});document.dispatchEvent(i),r.editManager=void 0}}}}return Object(r["a"])(e,[{key:"heightReference",get:function(){return this._heightReference},set:function(e){if(this._heightReference=e,this.editManager)if(this.editManager.heightReference=e,"POLYLINE"===this.editManager.type)this.editManager.graphic.polyline.clampToGround=/.*GROUND.*/.test(e),this.editManager.options.polyline.clampToGround=/.*GROUND.*/.test(e);else if("POLYGON"===this.editManager.type){var t=this.editManager.graphic,i=this.editManager.options;/.*GROUND.*/.test(e)?(t.polygon.perPositionHeight=!1,this.editManager.outline&&(this.editManager.outlineGraphic.graphic.polyline.clampToGround=!0),i.polygon.perPositionHeight=!1):(t.polygon.perPositionHeight=!0,this.editManager.outline&&(this.editManager.outlineGraphic.graphic.polyline.clampToGround=!1),i.polygon.perPositionHeight=!0)}}},{key:"material",get:function(){return this._material},set:function(e){this._material=e,this.editManager&&("POLYLINE"===this.editManager.type?(this.editManager.graphic.polyline.material=this._material,this.editManager.options.polyline.material=this._material):"POLYGON"===this.editManager.type&&(this.editManager.graphic.polygon.material=this._material,this.editManager.options.polygon.material=this._material))}},{key:"style",get:function(){return this._style},set:function(e){if(this._style=e,this.editManager){for(var t=Object.keys(e),i=0,n=t;i<n.length;i++){var r=n[i];"POLYLINE"===this.editManager.type?(this.editManager.graphic.polyline[r]=e[r],this.editManager.options.polyline[r]=e[r]):"POLYGON"===this.editManager.type&&("outline"!==r&&(this.editManager.graphic.polygon[r]=e[r]),this.editManager.options.polygon[r]=e[r])}"POLYGON"===this.editManager.type&&(this.editManager.outlineStyle=e)}}},{key:"createPolyline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a["f"].defaultStyle;this.graphicType=s["a"].POLYLINE;var t=this.generateId();e.positions=this.positions,/.*GROUND.*/.test(this._heightReference)?e.clampToGround=!0:e.clampToGround=!1,e.material=this.material||e.material,e.width=this.style.width||e.width;var i=new a["f"](this.viewer,e);this.tip.updateText("左键标绘，右键结束."),this.tip.visible=!0,i.gvid=t,i.heightReference=this.heightReference,this.manager.set(t,i),this.graphicId=t,this.editManager=i;var n=new CustomEvent("addEvent",{detail:{gvid:i.gvid,gvtype:i.gvtype,gvname:i.gvname,options:e}});document.dispatchEvent(n);var r=this;return this.handler.setInputAction((function(e){r.tip&&r.tip.updatePosition(e.endPosition)}),v),this.addEventListener(),i}},{key:"createPolygon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a["e"].defaultStyle;this.graphicType=s["a"].POLYGON;var t=this.generateId();this.graphicId=t,e.positions=this.positions,/.*GROUND.*/.test(this._heightReference)?e.perPositionHeight=!1:e.perPositionHeight=!0,e.material=this.material||e.material,e.outlineWidth=this.style.outlineWidth||e.outlineWidth,e.outlineColor=this.style.outlineColor||e.outlineColor;var i=new a["e"](this.viewer,e);i.gvid=t,i.heightReference=this.heightReference,this.tip.visible=!0,this.tip.updateText("左键标绘，右键结束."),this.manager.set(t,i),this.editManager=i;var n=new CustomEvent("addEvent",{detail:{gvid:i.gvid,gvtype:i.gvtype,gvname:i.gvname,options:e}});document.dispatchEvent(n);var r=this;return this.handler.setInputAction((function(e){r.tip&&r.tip.updatePosition(e.endPosition)}),v),this.addEventListener(),i}},{key:"generateId",value:function(){return(1e7*Math.random()).toString(16).substr(0,4)+"-"+(new Date).getTime()+"-"+Math.random().toString().substr(2,5)}},{key:"isKnownGraphic",value:function(e){return!(!(p(e)&&e.id instanceof h.Entity)||e.id.gvtype!==s["a"].POLYLINE&&e.id.gvtype!==s["a"].POLYGON&&e.id.gvtype!==s["a"].POINT)}},{key:"highlightedNode",value:function(e,t){var i,n=a["d"].selectedStyle,r=a["d"].defaultStyle,o=c(t.graphic);try{for(o.s();!(i=o.n()).done;){var s=i.value;s===e?a["d"].setStyle(s,n):a["d"].setStyle(s,r)}}catch(l){o.e(l)}finally{o.f()}}},{key:"addEventListener",value:function(){var e=this,t=this.viewer,i=function(i){if("edit"!==e.mode){if(e.graphicType==s["a"].POLYLINE||e.graphicType==s["a"].POLYGON){var n=o["a"].pixel2Cartesian(i.position,e.viewer);if(/.*MODEL.*/.test(e._heightReference)){if(!t.scene.pickPositionSupported)return void m.log("This browser does not support pickPosition.");n=t.scene.pickPosition(i.position)}0===e.manager.get(e.graphicId).positions.length&&(e.handler.removeInputAction(v),e.handler.setInputAction(r,v)),p(n)&&e.manager.has(e.graphicId)&&e.manager.get(e.graphicId).addNode(n),e.mode="create"}}else{if(!e.editManager)return void e.removeEventListener();var a,d=e.editManager.nodeGraphic||e.editManager.outlineGraphic.nodeGraphic,u=t.scene.drillPick(i.position),h=!1,f=void 0,g=c(u);try{for(g.s();!(a=g.n()).done;){var y=a.value;if(h=e.isKnownGraphic(y),h&&y.id.gvtype===s["a"].POINT){f=y,e.handler.removeInputAction(_),e.handler.removeInputAction(v),e.handler.setInputAction(l,_),e.handler.setInputAction(r,v);break}}}catch(k){g.e(k)}finally{g.f()}if(f&&h)f.id.gvtype===s["a"].POINT?(e.selectedNodeIndex=d.contain(f.id),-1!==e.selectedNodeIndex&&e.highlightedNode(f.id,d)):(e.highlightedNode(f.id,e.editManager.nodeGraphic),e.selectedNodeIndex=-1);else{e.editManager&&e.editManager.stopEdit(),e.removeEventListener(),e.mode="end",e.selectedNodeIndex=-1,e.editManager=void 0,e.tip.visible=!1;var w=new CustomEvent("stopEdit");document.dispatchEvent(w)}}},n=function(){var t=e.manager.get(e.graphicId);if("create"===e.mode&&t){var i=null;i=JSON.stringify(t.toGeoJson().geometry),window.vue.$store.commit("updateElement",{ele:{id:e.graphicId,geojson:i}}),t.stopEdit(),e.graphicType=void 0,e.graphicId=void 0,e.positions=[],e.mode="end",e.tip.visible=!1,e.editManager=void 0;var n=new CustomEvent("stopEdit");document.dispatchEvent(n)}else"ready"===e.mode?e.cancel():"edit"===e.mode&&(e.editManager&&e.editManager.stopEdit(),e.removeEventListener(),e.mode="end",e.selectedNodeIndex=-1,e.editManager=void 0,e.tip.visible=!1);var r=new CustomEvent("stopEdit");document.dispatchEvent(r),e.removeEventListener()},r=function(i){var n=o["a"].pixel2Cartesian(i.endPosition,e.viewer);if(/.*MODEL.*/.test(e._heightReference)){if(!t.scene.pickPositionSupported)return void m.log("This browser does not support pickPosition.");n=t.scene.pickPosition(i.endPosition)}p(n)&&(e.tip.updatePosition(i.endPosition),"create"===e.mode?(e.positions.length>1&&e.manager.get(e.graphicId).popNode(),e.positions.length>0&&e.manager.get(e.graphicId).addNode(n)):"edit"==e.mode&&e.dragging&&-1!==e.selectedNodeIndex&&e.editManager.updateNode(e.selectedNodeIndex,n))},l=function(i){e.handler.setInputAction(d,y);var n,r=t.scene.drillPick(i.position),o=!1,s=c(r);try{for(s.s();!(n=s.n()).done;){var l=n.value;a["d"].isCesiumPoint(l)&&(o=!0)}}catch(u){s.e(u)}finally{s.f()}0!=o&&"edit"===e.mode&&-1!=e.selectedNodeIndex&&(e.dragging=!0,t.scene.screenSpaceCameraController.enableRotate=!1)},d=function(){e.dragging=!1,t.scene.screenSpaceCameraController.enableRotate=!0,e.handler.removeInputAction(y)};this.handler.setInputAction(i,f),this.handler.setInputAction(n,g)}},{key:"rename",value:function(e,t){var i=this.manager.get(e);p(i)&&(i.gvname=t)}},{key:"has",value:function(e){return!!this.manager&&this.manager.has(e)}},{key:"get",value:function(e){if(this.has(e))return this.manager.get(e)}},{key:"cancel",value:function(){var e=this.manager.get(this.graphicId);e&&e.stopEdit(),e&&e.destroy(),this.graphicType=void 0,this.graphicId=void 0,this.positions=[],this.mode="end",this.tip.visible=!1,this.editManager=void 0}},{key:"select",value:function(e,t,i){if(p(t)){var n=this.manager.get(t);n&&(n.show=i)}if(p(e)){var r,a=this.manager.values(),o=c(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.gvtype===e&&(s.show=i)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"edit",value:function(e){var t=this,i=t.manager.get(e);if(this.handler.setInputAction((function(e){t.tip.updatePosition(e.endPosition)}),v),t.graphicId=e,p(i)){t.mode="edit",i.startEdit(),t.tip.visible=!0,t.tip.updateText("拖动节点编辑，按del删除."),t.editManager=i;var n=new CustomEvent("startEdit",{detail:{graphicType:t.editManager.type,material:t.editManager.material,width:t.editManager.width,outline:t.editManager.outline,outlineColor:t.editManager.outlineColor,outlineWidth:t.editManager.outlineWidth,heightReference:t.editManager.heightReference}});document.dispatchEvent(n),t.addEventListener()}}},{key:"export",value:function(e){var t,i={type:"FeatureCollection",name:"graphic",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:[]},n=this.manager.values(),r=c(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.type===e&&i.features.push(a.toGeoJson())}}catch(s){r.e(s)}finally{r.f()}var o=new Blob([JSON.stringify(i)],{type:""});Object(l["saveAs"])(o,e+parseInt(h.getTimestamp())+".geojson")}},{key:"import",value:function(e){var t,i,n=this.generateId(),r=[];if(e.geometry.type.toUpperCase()==="LineString".toUpperCase()){i=e.geometry.coordinates;var o,s=c(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;r.push({lon:l[0],lat:l[1],height:l[2]})}}catch(f){s.e(f)}finally{s.f()}try{t=a["f"].fromDegrees(this.viewer,r,e.properties)}catch(g){m.log(g)}}else{if("POLYGON"!==e.geometry.type.toUpperCase())throw new Error("不能识别的数据源.");i=e.geometry.coordinates[0];var d,u=c(i);try{for(u.s();!(d=u.n()).done;){var h=d.value;r.push({lon:h[0],lat:h[1],height:h[2]})}}catch(f){u.e(f)}finally{u.f()}t=a["e"].fromDegrees(this.viewer,r,e.properties)}if(t){t.gvid=n,t.gvname=e.properties.name,this.manager.set(n,t);var p=new CustomEvent("addEvent",{detail:{gvid:t.gvid,gvtype:t.gvtype,gvname:t.gvname||"未命名"}});document.dispatchEvent(p)}return t}},{key:"removeEventListener",value:function(){this.handler.removeInputAction(f),this.handler.removeInputAction(v),this.handler.removeInputAction(g),this.handler.removeInputAction(_),this.handler.removeInputAction(y)}},{key:"removeAll",value:function(){var e,t=this.manager.values(),i=c(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.remove(),n.destroy()}}catch(r){i.e(r)}finally{i.f()}this.manager.clear(),this.tip.visible=!1}},{key:"destroy",value:function(){this.activeManager=void 0,this.manager=void 0,this.editManager=void 0,this.removeEventListener(),this.handler.isDestroyed||(this.handler.destroy(),this.handler=void 0)}},{key:"destroyManager",value:function(){var e=this.editManager,t=new CustomEvent("destroyEvent",{detail:{gvid:e?e.gvid:void 0}});e&&("edit"===this.mode?e&&e.stopEdit():(e&&e.destroy(),this.manager.delete(this.graphicId)),this.editManager=void 0),this.graphicId=void 0,this.handler.removeInputAction(v),document.dispatchEvent(t)}}]),e}();t["a"]=w},"53bd":function(e,t,i){},5553:function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),r=i("5c96"),a=i.n(r),o=(i("0fae"),i("f309")),s=(i("3a10"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("map-viewer",{ref:"mapViewer"})],1)}),l=[],c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("cesiumContainer"),i("cesiumDrawViewer",{ref:"marker",attrs:{extendMarkerImage:e.imags}}),i("fileManagerButton"),i("left-container")],1)},d=[],u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fullSize",staticStyle:{height:"100%"}},[i("div",{staticClass:"full-container",style:e.viewStyle,attrs:{id:"cesiumContainer"}}),e._m(0)])},h=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"loadingOverlay"}},[i("h1",[e._v("Loading...")])])}],p={name:"CesiumContainer",viewerProperty:{},props:{viewStyle:{},viewerProperty:{},dropBackground:{default:!1}},components:{},data:function(){return{viewer:null}},computed:{},mounted:function(){var e=window.Cesium,t=this,i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwMDhmOGU1Mi1kYTU4LTQ1ZGUtOWQxZS0yMGJiYWMyNjhhOTMiLCJpZCI6MzUyNDUsImlhdCI6MTYwMTU5MTMwMX0.Y0vt0Lnp7En8YK3HqUz8ac-JDnZyAR79qnyh4tKssdE",n="612ae65756225e3affda8a30ac248fb6",r=["0","1","2","3","4","5","6","7"];for(var a in e.Ion.defaultAccessToken=i,t.viewerDefaultProperty={animation:!1,homeButton:!0,geocoder:!1,baseLayerPicker:!1,timeline:!1,fullscreenButton:!0,infoBox:!1,sceneModePicker:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,selectionIndicator:!0,imageryProvider:new e.WebMapTileServiceImageryProvider({url:"http://t{s}.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk="+n,subdomains:r,layer:"tdtImgLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!0})},t.viewerProperty)t.viewerDefaultProperty[a]=t.viewerProperty[a];var o=new e.Viewer("cesiumContainer",{animation:!1,homeButton:!0,geocoder:!1,baseLayerPicker:!1,timeline:!1,fullscreenButton:!0,infoBox:!1,sceneModePicker:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,selectionIndicator:!0,imageryProvider:new e.WebMapTileServiceImageryProvider({url:"http://t{s}.tianditu.com/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default&format=tiles&tk="+n,subdomains:r,layer:"tdtImgLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible",show:!0})});window.cesiumViewer=o,window.viewer=o,o.extend(e.viewerDragDropMixin),o.dropError.addEventListener((function(e,t,i){console.log(i),window.alert(i)})),o.scene.screenSpaceCameraController.minimumZoomDistance=1e3,o.scene.screenSpaceCameraController.maximumZoomDistance=2e7,o.scene.screenSpaceCameraController._minimumZoomRate=3e4,o.scene.screenSpaceCameraController._maximumZoomRate=5906376272e3,o.imageryLayers.addImageryProvider(new e.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk="+n,layer:"tdtAnnoLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible"}));var s={camera:o.scene.camera,canvas:o.scene.canvas,offset:new e.HeadingPitchRange(e.Math.toRadians(0),e.Math.toRadians(-90),0),clampToGround:!0};window.options=s;var l=document.getElementsByClassName("cesium-widget-credits");l[0].parentElement.removeChild(l[0]),o.cesiumWidget.screenSpaceEventHandler.removeInputAction(e.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),o.scene.postProcessStages.fxaa.enabled=!1,o.camera.flyTo({destination:e.Cartesian3.fromDegrees(103.84,31.15,7e6),orientation:{heading:e.Math.toRadians(348.4202942851978),pitch:e.Math.toRadians(-89.74026687972041),roll:e.Math.toRadians(0)}}),o.homeButton.viewModel.command.beforeExecute.addEventListener((function(t){t.cancel=!0,o.camera.flyTo({destination:e.Cartesian3.fromDegrees(103.84,31.15,7e6),orientation:{heading:e.Math.toRadians(348.4202942851978),pitch:e.Math.toRadians(-89.74026687972041),roll:e.Math.toRadians(0)},complete:function(){}})}))},methods:{}},m=p,f=(i("dec1"),i("2877")),g=Object(f["a"])(m,u,h,!1,null,null,null),v=g.exports,_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"left"},[i("v-expansion-panels",[i("v-expansion-panel",[i("v-expansion-panel-header",[e._v(" 文件 ")]),i("v-expansion-panel-content",[i("left-tree-file")],1)],1),i("v-expansion-panel",[i("v-expansion-panel-header",[e._v(" 图层 ")]),i("v-expansion-panel-content")],1),i("v-expansion-panel",[i("v-expansion-panel-header",[e._v(" 位置 ")]),i("v-expansion-panel-content",[i("left-tree-place")],1)],1)],1)],1)},y=[],w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{left:"0",height:"auto"}},[i("v-app",{staticStyle:{left:"0",height:"auto"}},[i("v-main",[i("v-treeview",{attrs:{dense:"",selectable:"",items:e.items},model:{value:e.item_selected,callback:function(t){e.item_selected=t},expression:"item_selected"}})],1)],1)],1)},k=[],M=(i("96cf"),i("3b8d")),b=(i("6762"),i("2fdb"),i("9944")),E=b["b"].host,C={name:"leftTreeFile",data:function(){return{viewer:null,item_current:[],item_selected:[],ds:{},widgets:!1}},computed:{items:{get:function(){return this.$store.state.fileList},set:function(e){this.$store.commit("setFileList",{fileList:e})}}},methods:{addKML:function(e){var t=window.Cesium,i=window.options,n=t.KmlDataSource.load(E+"/d3/data/kml/"+e,i);this.viewer.dataSources.add(n),this.viewer.flyTo(n,i);var r=this;t.when(n,(function(t){r.ds[e]=t}))},remKML:function(e){var t=this.ds[e];this.viewer.dataSources.remove(t),delete this.ds[e]},loadKML:function(e){var t=this,i=[],n=[];for(var r in e){var a=e[r];a&&(this.item_current.includes(a)||i.push(a))}for(var o in this.item_current){var s=this.item_current[o];s&&(e.includes(s)||n.push(s))}this.item_current=this.item_selected,i.forEach((function(e){t.addKML(e)})),n.forEach((function(e){t.remKML(e)}))},list:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get(E+"/d3/group");case 2:t=e.sent,t&&t.data&&(i=t.data,"200"==i.code?(n=i.data,this.$store.commit("fileList",{fileList:n})):alert("获取树形列表出错:"+i.message));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},watch:{item_selected:function(e){this.loadKML(e)}},mounted:function(){this.viewer=window.cesiumViewer,this.list()}},O=C,P=(i("a28e"),i("6544")),x=i.n(P),L=i("7496"),D=i("f6c4"),A=i("eb2a"),I=Object(f["a"])(O,w,k,!1,null,"4ddcd0a8",null),S=I.exports;x()(I,{VApp:L["a"],VMain:D["a"],VTreeview:A["a"]});var T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{left:"0",height:"auto"}},[i("v-app",{staticStyle:{left:"0",height:"auto"}},[i("v-treeview",{attrs:{dense:"",selectable:"",items:e.items},scopedSlots:e._u([{key:"label",fn:function(t){var n=t.item;return[i("v-btn",{attrs:{text:"",id:n.id,type:n.type},on:{contextmenu:e.showContextMenu}},[e._v("\n              "+e._s(n.name||"未命名")+"\n            ")])]}}]),model:{value:e.item_selected,callback:function(t){e.item_selected=t},expression:"item_selected"}}),i("v-menu",{attrs:{"position-x":e.x,"position-y":e.y,fixed:"","close-on-content-click":e.contextMenuCloseOnContentClick},model:{value:e.showMenu,callback:function(t){e.showMenu=t},expression:"showMenu"}},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:e.contextMenuClickAction}},[i("v-list-item-content",[i("v-list-item-title",{attrs:{id:"rename"}},[e._v(" 重命名 ")])],1)],1),i("v-list-item",{on:{click:e.contextMenuClickAction}},[i("v-list-item-content",[i("v-list-item-title",{attrs:{id:"showGroups"}},[e._v("\n                  移动到\n                ")])],1)],1),i("v-list-item",{on:{click:e.contextMenuClickAction}},[i("v-list-item-content",[i("v-list-item-title",{attrs:{id:"del"}},[e._v(" 删除 ")])],1)],1)],1)],1),i("v-menu",{attrs:{"position-x":e.sub1_x,"position-y":e.sub1_y,fixed:""},model:{value:e.showSubMenuGroup,callback:function(t){e.showSubMenuGroup=t},expression:"showSubMenuGroup"}},[i("v-list",{attrs:{dense:""}},[e._l(e.groups,(function(t){return i("v-list-item",{key:t,attrs:{id:t},on:{click:e.moveToGroup}},[i("v-list-item-title",{domProps:{textContent:e._s(t)}})],1)})),i("v-divider"),i("v-list-item",{attrs:{id:"newGroup"},on:{click:e.moveToGroup}},[i("v-list-item-title",[e._v(" 新分组 ")])],1)],2)],1),i("v-dialog",{attrs:{"v-model":e.editMode,id:"editDialog",persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[i("v-btn",e._g(e._b({staticStyle:{display:"none"},attrs:{color:"primary",dark:"",id:"editModeSwith"}},"v-btn",r,!1),n),[e._v("\n            Open Dialog\n          ")])]}}])},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("修改")])]),i("v-card-text",[i("v-container",[i("v-text-field",{attrs:{label:"名称",required:""},model:{value:e.editedName,callback:function(t){e.editedName=t},expression:"editedName"}})],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onCloseEditDialog}},[e._v("\n              关闭\n            ")]),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onSaveEditDialog}},[e._v("\n              确认\n            ")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"600px"},model:{value:e.showNewGroupDialog,callback:function(t){e.showNewGroupDialog=t},expression:"showNewGroupDialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("新分组")])]),i("v-card-text",[i("v-container",[i("v-text-field",{attrs:{label:"名称",required:""},model:{value:e.newGroupName,callback:function(t){e.newGroupName=t},expression:"newGroupName"}})],1)],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onCloseNewGroupDialog}},[e._v("\n              关闭\n            ")]),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onSaveNewGroupDialog}},[e._v("\n              确认\n            ")])],1)],1)],1),i("v-dialog",{attrs:{"max-width":"600px",persistent:""},model:{value:e.showConfirmDelDialog,callback:function(t){e.showConfirmDelDialog=t},expression:"showConfirmDelDialog"}},[i("v-card",[i("v-card-title",[i("span",{staticClass:"headline"},[e._v("提示")])]),i("v-card-text",[i("v-container",[e._v(" 确认删除吗？ ")])],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onCloseDelDialog}},[e._v("\n              关闭\n            ")]),i("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.onConfirmDelDialog}},[e._v("\n              确认\n            ")])],1)],1)],1)],1)],1)},j=[],R=(i("ac4d"),i("8a81"),i("5df3"),i("1c4c"),i("6b54"),i("8e6e"),i("ac6a"),i("456d"),i("7f7f"),i("bd86")),N=(i("f559"),i("cd53"));function G(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=B(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function B(e,t){if(e){if("string"===typeof e)return V(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?V(e,t):void 0}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function U(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function W(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?U(Object(i),!0).forEach((function(t){Object(R["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var K=b["e"].CVT,$=b["b"].host,H={name:"leftTreePlace",data:function(){return{viewer:null,item_current:[],item_selected:[],ds:{},widgets:!1,showMenu:!1,x:0,y:0,sub1_x:0,sub1_y:0,editMode:!1,editedName:"",rightClickId:"",showSubMenuGroup:!1,groups:[],opItemId:null,contextMenuCloseOnContentClick:!1,showNewGroupDialog:!1,newGroupName:"",showConfirmDelDialog:!1}},computed:{items:{get:function(){return this.$store.state.elementList},set:function(e){this.$store.commit("elementList",{elementList:e})}}},methods:{onCloseDelDialog:function(){this.showConfirmDelDialog=!1},onConfirmDelDialog:function(){if(this.opItemId)if(this.opItemId.startsWith("group-")){var e=this.opItemId;this.$store.commit("dropGroup",{group:{id:e}})}else this.$store.commit("dropElement",{ele:{id:this.opItemId,type:"marker"}});this.onCloseDelDialog()},onSaveNewGroupDialog:function(){this.rightClickId&&this.newGroupName&&this.$store.commit("updateElement",{ele:{id:this.rightClickId,group:this.newGroupName}}),this.onCloseNewGroupDialog()},onCloseNewGroupDialog:function(){this.showNewGroupDialog=!1},moveToGroup:function(e){var t=e.target.id||e.target.parentNode.id||e.target.parentNode.parentNode.id;t&&("newGroup"==t?this.showNewGroupDialog=!0:this.rightClickId&&this.$store.commit("updateElement",{ele:{id:this.rightClickId,group:t}}))},contextDel:function(){this.showConfirmDelDialog=!0},contextRename:function(){this.editMode=!0,this.editedName=this.rightClickName,document.getElementById("editModeSwith").click()},contextShowGroups:function(){var e=document.getElementById("showGroups").parentNode.parentNode,t=e.offsetWidth,i=e.offsetHeight;this.sub1_x=this.x+t,this.sub1_y=this.y+i,this.showSubMenuGroup=!0},onCloseEditDialog:function(){document.getElementById("editModeSwith").click(),this.rightClickId=null,this.editedName=null,this.rightClickName=null},onSaveEditDialog:function(){var e=this.rightClickId,t=this.editedName;this.$store.commit("updateElement",{ele:{id:e,name:t}}),this.onCloseEditDialog()},contextMenuClickAction:function(e){var t=e.target.id;switch(t){case"del":this.contextDel(),this.showMenu=!1;break;case"rename":this.contextRename(),this.showMenu=!1;break;case"showGroups":this.contextShowGroups()}},showContextMenu:function(e){var t=this;e.preventDefault(),this.rightClickId=e.target.id,null!==this.rightClickId&&0!==this.rightClickId.length||(this.rightClickId=e.target.parentNode.id),this.rightClickName=e.target.textContent.trim(),this.showMenu=!1,this.x=e.clientX,this.y=e.clientY,this.opItemId=e.target.id||e.target.parentElement.id,this.$nextTick((function(){t.showMenu=!0}))},showPoint:function(e,t,i,n,r){var a=window.Cesium,o=0,s=e.coordinates[0],l=e.coordinates[1],c=e.coordinates[2],d=a.Cartesian3.fromDegrees(s,l,c),u=top.markerManager,h=u.createMarker(d,r);top.markers.set(t,h),h.gvid=t,h.gvname=i,u.selectedMarker=h,u.activeMarker=h;var p=i,m=new CustomEvent("marker-add",{detail:{id:h.gvid,name:p||"未命名",description:n,type:o,position:K.toDegrees(d,window.viewer)}});window.dispatchEvent(m),window.drawViewer.locateGraphic(t),h=null},showPolyline:function(e,t,i,n,r){var a=window.Cesium;if(r){r=JSON.parse(r);var o=r.material;r.material=new a.Color(o.red,o.green,o.blue,o.alpha)}var s=W({positions:[]},r);if(e&&e.coordinates&&e.coordinates.length>0){var l,c=G(e.coordinates);try{for(c.s();!(l=c.n()).done;){var d=l.value,u=d[0],h=d[1],p=d[2],m=a.Cartesian3.fromDegrees(u,h,p);s.positions.push(m)}}catch(v){c.e(v)}finally{c.f()}/.*GROUND.*/.test(window.graphicManager._heightReference)?s.clampToGround=!0:s.clampToGround=!1,s.material=window.graphicManager.material||s.material,s.width=window.graphicManager.style.width||s.width;var f=new N["f"](window.viewer,s);window.graphics.set(t,f),f.gvid=t,f.id=t,f.gvname=i,f.gvtype="polyline",f.gvdesp=n,f.heightReference=window.graphicManager.heightReference;var g=new CustomEvent("addEvent",{detail:{gvid:f.gvid,gvtype:1,gvname:f.gvname,gvdesp:f.gvdesp}});document.dispatchEvent(g),window.drawViewer.locateGraphic(t)}},showPolygon:function(e,t,i,n,r){var a=window.Cesium;if(r){r=JSON.parse(r);var o=r.material;r.material=new a.Color(o.red,o.green,o.blue,o.alpha);var s=r.outlineColor;r.outlineColor=new a.Color(s.red,o.green,o.blue,o.alpha)}var l=W({positions:[]},r);if(e&&e.coordinates&&e.coordinates.length>0){var c,d=G(e.coordinates[0]);try{for(d.s();!(c=d.n()).done;){var u=c.value,h=u[0],p=u[1],m=u[2],f=a.Cartesian3.fromDegrees(h,p,m);l.positions.push(f)}}catch(_){d.e(_)}finally{d.f()}var g=new N["e"](window.viewer,l);window.graphics.set(t,g),g.gvid=t,g.id=t,g.gvname=i,g.gvtype="polygon",g.gvdesp=n,g.heightReference=window.graphicManager.heightReference;var v=new CustomEvent("addEvent",{detail:{gvid:g.gvid,gvtype:2,gvname:g.gvname,gvdesp:g.gvdesp}});document.dispatchEvent(v),window.drawViewer.locateGraphic(t)}},addGeoJSON:function(e){var t=this;fetch($+"/d3/data/element/"+e,{method:"get",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){if(1==e.state){var i=e.data,n=i.id,r=i.name,a=i.desp,o=i.style;if(!top.markers.has(n)&&!top.graphics.has(n)){var s=JSON.parse(i.geoJson);switch(s.type){case"Point":t.showPoint(s,n,r,a,o);break;case"LineString":t.showPolyline(s,n,r,a,o);break;case"Polygon":t.showPolygon(s,n,r,a,o);break;case"Label":break}}}}))},remGeoJSON:function(e){var t=this.ds[e];this.viewer.dataSources.remove(t);var i=window.vue.$children[0].$refs.mapViewer.$refs.marker.$refs.layerManager;i.drop({id:e}),delete this.ds[e]},loadGeoJSON:function(e){var t=this,i=[],n=[];for(var r in e){var a=e[r];a&&(this.item_current.includes(a)||i.push(a))}for(var o in this.item_current){var s=this.item_current[o];s&&(e.includes(s)||n.push(s))}this.item_current=this.item_selected,i.forEach((function(e){t.addGeoJSON(e)})),n.forEach((function(e){t.remGeoJSON(e)}))},list:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get($+"/d3/data/element/tree");case 2:t=e.sent,t&&t.data&&(i=t.data,"200"==i.code?(n=i.data,this.$store.commit("elementList",{elementList:n})):alert("出错:"+i.message));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getGroups:function(){var e=Object(M["a"])(regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get($+"/d3/data/element/group");case 2:t=e.sent,t&&t.data&&(i=t.data,"200"==i.code?(n=i.data,this.groups=n):alert("出错:"+i.message));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},watch:{item_selected:function(e){this.loadGeoJSON(e)}},mounted:function(){this.viewer=window.cesiumViewer,this.list(),this.getGroups()}},Y=H,z=(i("26a8"),i("8336")),J=i("b0af"),F=i("99d9"),q=i("a523"),Q=i("169a"),Z=i("ce7e"),X=i("8860"),ee=i("da13"),te=i("5d23"),ie=i("e449"),ne=i("2fa4"),re=i("8654"),ae=Object(f["a"])(Y,T,j,!1,null,"b3ddb858",null),oe=ae.exports;x()(ae,{VApp:L["a"],VBtn:z["a"],VCard:J["a"],VCardActions:F["a"],VCardText:F["b"],VCardTitle:F["c"],VContainer:q["a"],VDialog:Q["a"],VDivider:Z["a"],VList:X["a"],VListItem:ee["a"],VListItemContent:te["a"],VListItemTitle:te["b"],VMenu:ie["a"],VSpacer:ne["a"],VTextField:re["a"],VTreeview:A["a"]});var se={components:{leftTreeFile:S,leftTreePlace:oe}},le=se,ce=(i("00d6"),i("cd55")),de=i("49e2"),ue=i("c865"),he=i("0393"),pe=Object(f["a"])(le,_,y,!1,null,null,null),me=pe.exports;x()(pe,{VContainer:q["a"],VExpansionPanel:ce["a"],VExpansionPanelContent:de["a"],VExpansionPanelHeader:ue["a"],VExpansionPanels:he["a"]});var fe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{id:"drawtoolPanel"}},[i("el-container",[i("el-main",{staticClass:"graphic-draw-main"},[i("ul",[i("li",[i("i",{staticClass:"iconfont iconmarker icon-class",class:{"selected-graphic":e.menuSelected["MARKER"]},attrs:{title:"添加标记"},on:{click:function(t){return e.menuAction("MARKER")}}}),i("span",{class:{"selected-graphic":e.menuSelected["MARKER"]},on:{click:function(t){return e.menuAction("MARKER")}}},[e._v("标记")])]),i("li",[i("i",{staticClass:"iconfont iconpolyline icon-class",class:{"selected-graphic":e.menuSelected["POLYLINE"]},attrs:{title:"添加线段"},on:{click:function(t){return e.menuAction("POLYLINE")}}}),i("span",{class:{"selected-graphic":e.menuSelected["POLYLINE"]},on:{click:function(t){return e.menuAction("POLYLINE")}}},[e._v("折线")])]),i("li",[i("i",{staticClass:"iconfont iconpolygon icon-class",class:{"selected-graphic":e.menuSelected["POLYGON"]},attrs:{title:"添加多边形"},on:{click:function(t){return e.menuAction("POLYGON")}}}),i("span",{class:{"selected-graphic":e.menuSelected["POLYGON"]},on:{click:function(t){return e.menuAction("POLYGON")}}},[e._v("多边形")])]),i("li",[i("i",{staticClass:"iconfont iconlabel icon-class",class:{"selected-graphic":e.menuSelected["LABEL"]},attrs:{title:"添加文字"},on:{click:function(t){return e.menuAction("LABEL")}}}),i("span",{class:{"selected-graphic":e.menuSelected["LABEL"]},on:{click:function(t){return e.menuAction("LABEL")}}},[e._v("文字")])]),e.extendMarkerModel.length?i("li",[i("i",{staticClass:"iconfont iconmodel icon-class",class:{"selected-graphic":e.menuSelected["MODEL"]},attrs:{title:"添加模型"},on:{click:function(t){return e.menuAction("MODEL")}}}),i("span",{class:{"selected-graphic":e.menuSelected["MODEL"]},on:{click:function(t){return e.menuAction("MODEL")}}},[e._v("模型")])]):e._e(),i("li",[i("i",{staticClass:"iconfont iconlayer icon-class",class:{"selected-graphic":e.layerManagerVisible},attrs:{title:"图层管理"},on:{click:function(t){e.layerManagerVisible=!e.layerManagerVisible}}}),i("span",{class:{"selected-graphic":e.layerManagerVisible},on:{click:function(t){e.layerManagerVisible=!e.layerManagerVisible}}},[e._v("清单")])])])])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.editMode,expression:"editMode"}],staticClass:"graphic-edit"},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.menuSelected["MARKER"],expression:"menuSelected['MARKER']"}],staticClass:"marker-edit-class edit-class"},[i("el-color-picker",{attrs:{id:"markerColor","show-alpha":"",size:"mini"},model:{value:e.markerColor,callback:function(t){e.markerColor=t},expression:"markerColor"}}),i("el-select",{attrs:{size:"mini","allow-create":"",filterable:"",title:"字号","default-first-option":"",placeholder:"请选择"},model:{value:e.fontSize,callback:function(t){e.fontSize=t},expression:"fontSize"}},e._l(e.fontSizeList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),i("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.markerOptionsVisible,callback:function(t){e.markerOptionsVisible=t},expression:"markerOptionsVisible"}},[i("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请在此定义LabelGraphic"},model:{value:e.markerOption,callback:function(t){e.markerOption=t},expression:"markerOption"}}),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.markerOption="",e.markerOptionsVisible=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setLabel}},[e._v("确定")])],1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.menuSelected["POLYLINE"],expression:"menuSelected['POLYLINE']"}],staticClass:"polyline-edit-class edit-class"},[i("el-color-picker",{attrs:{title:"颜色",id:"lineColor","show-alpha":"",size:"mini"},model:{value:e.lineColor,callback:function(t){e.lineColor=t},expression:"lineColor"}}),i("el-select",{staticClass:"width-selector",attrs:{size:"mini",title:"线宽","allow-create":"",filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:e.lineWidth,callback:function(t){e.lineWidth=t},expression:"lineWidth"}},e._l(e.lineWidthList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),i("el-select",{staticClass:"style-selector",attrs:{size:"mini",title:"直线样式","default-first-option":"",placeholder:"请选择"},model:{value:e.lineStyle,callback:function(t){e.lineStyle=t},expression:"lineStyle"}},e._l(e.lineStyleList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),i("el-select",{staticClass:"type-selector",attrs:{size:"mini",title:"直线类型","default-first-option":"",placeholder:"请选择"},model:{value:e.graphicHeight,callback:function(t){e.graphicHeight=t},expression:"graphicHeight"}},e._l(e.heightList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.menuSelected["POLYGON"],expression:"menuSelected['POLYGON']"}],staticClass:"polygon-edit-class edit-class"},[i("el-color-picker",{attrs:{title:"填充色",id:"polygonColor","show-alpha":"",size:"mini"},model:{value:e.polygonColor,callback:function(t){e.polygonColor=t},expression:"polygonColor"}}),i("el-select",{staticClass:"type-selector",attrs:{size:"mini",title:"多边形类型","default-first-option":"",placeholder:"请选择"},model:{value:e.graphicHeight,callback:function(t){e.graphicHeight=t},expression:"graphicHeight"}},e._l(e.heightList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),i("i",{staticClass:"iconfont iconoutline border-btn",class:{"outline-selected":e.outline},attrs:{title:"边框"},on:{click:function(t){e.outline=!e.outline}}}),i("el-color-picker",{directives:[{name:"show",rawName:"v-show",value:e.outline,expression:"outline"}],attrs:{title:"边框充色",id:"outlineColor","show-alpha":"",size:"mini"},model:{value:e.outlineColor,callback:function(t){e.outlineColor=t},expression:"outlineColor"}}),i("el-select",{directives:[{name:"show",rawName:"v-show",value:e.outline,expression:"outline"}],staticClass:"width-selector",attrs:{size:"mini",title:"边框宽度","allow-create":"",filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:e.outlineWidth,callback:function(t){e.outlineWidth=t},expression:"outlineWidth"}},e._l(e.lineWidthList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.menuSelected["LABEL"],expression:"menuSelected['LABEL']"}],staticClass:"label-edit-class edit-class"},[i("el-select",{staticClass:"font-selector",attrs:{"allow-create":"",filterable:"",size:"mini",title:"字体","default-first-option":"",placeholder:"请选择"},model:{value:e.fontFamily,callback:function(t){e.fontFamily=t},expression:"fontFamily"}},e._l(e.fontList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),i("el-select",{staticClass:"size-selector",attrs:{size:"mini","allow-create":"",filterable:"",title:"字号","default-first-option":"",placeholder:"请选择"},model:{value:e.fontSize,callback:function(t){e.fontSize=t},expression:"fontSize"}},e._l(e.fontSizeList,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),i("el-color-picker",{attrs:{title:"颜色",id:"labelColor","show-alpha":"",size:"mini"},model:{value:e.markerColor,callback:function(t){e.markerColor=t},expression:"markerColor"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.menuSelected["MODEL"],expression:"menuSelected['MODEL']"}],staticClass:"model-edit-class edit-class"},[i("el-popover",{attrs:{placement:"bottom",id:"model-select",width:"160"},model:{value:e.modelSelectPanelvisible,callback:function(t){e.modelSelectPanelvisible=t},expression:"modelSelectPanelvisible"}},[i("div",{staticClass:"model-select-panel"},e._l(e.extendMarkerModel,(function(t){return i("img",{key:t.id,attrs:{title:t.name,src:e.modelThumb(t),onerror:e.defaultImage},on:{click:function(i){return e.selectModel(t)}}})})),0),i("i",{staticClass:"iconfont iconmodel model-selector-trigger",attrs:{slot:"reference",title:"选择模型"},slot:"reference"})]),i("el-select",{attrs:{size:"mini",title:"模式","default-first-option":"",placeholder:"请选择"},model:{value:e.modelMode,callback:function(t){e.modelMode=t},expression:"modelMode"}},e._l(e.modelModeList,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),i("el-color-picker",{attrs:{title:"颜色",id:"modelColor","show-alpha":"",size:"mini"},model:{value:e.modelColor,callback:function(t){e.modelColor=t},expression:"modelColor"}}),i("el-slider",{directives:[{name:"show",rawName:"v-show",value:"Mix"===e.modelMode,expression:"modelMode==='Mix'"}],attrs:{title:"混合度",min:0,max:1,step:.1,"show-tooltip":!0},model:{value:e.modelMixed,callback:function(t){e.modelMixed=t},expression:"modelMixed"}})],1)]),i("MarkerViewer",{ref:"markerManager",attrs:{attachment:e.attachment,extendImage:e.extendMarkerImage},on:{deleteEvent:e.deleteMarker,editEvent:e.editMarker,addEvent:e.addMarker,updateEvent:e.updateMarker}}),i("layerManager",{directives:[{name:"show",rawName:"v-show",value:e.layerManagerVisible,expression:"layerManagerVisible"}],ref:"layerManager",staticClass:"layer-manager-class",class:{"edit-layer-manager-class":e.editMode},attrs:{tools:e.tools},on:{locate:e.locateGraphic,edit:e.editGraphic,delete:e.deleteGraphic,rename:e.renameGraphic,select:e.selectGraphic,clear:e.clearGraphic,close:e.closeLayerManager,import:e.importGraphic,export:e.exportGraphic}}),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"file",id:"graphicuploadhandler",accept:".geojson, .shp"},on:{change:e.importfp}})],1)},ge=[],ve=i("5afc"),_e=ve["a"],ye=(i("c6cc"),i("bd73"),Object(f["a"])(_e,fe,ge,!1,null,"08c4928a",null)),we=ye.exports,ke=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fileManagerButton"},[i("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,r=t.attrs;return[i("svg",e._g(e._b({staticStyle:{width:"24px",height:"24px",margin:"5px 5px 0px 8px"},attrs:{viewBox:"0 0 24 24"}},"svg",r,!1),n),[i("path",{attrs:{fill:"currentColor",d:"M17,14H19V17H22V19H19V22H17V19H14V17H17V14M11,16L2,9L11,2L20,9L11,16M11,18.54L12,17.75V18C12,18.71 12.12,19.39 12.35,20L11,21.07L2,14.07L3.62,12.81L11,18.54Z"}})])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[i("v-card",[i("v-toolbar",{attrs:{dark:"",color:"primary"}},[i("v-btn",{attrs:{icon:"",dark:""},on:{click:function(t){e.dialog=!1}}},[i("v-icon",[e._v("mdi-close")])],1),i("v-toolbar-title",[e._v("文件管理")]),i("v-spacer")],1),i("v-form",{staticStyle:{"margin-top":"20px"}},[i("v-container",[i("v-row",{attrs:{justify:"start"}},[i("v-col",[i("v-file-input",{attrs:{required:"","show-size":"",accept:e.accept,label:e.label},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),i("v-spacer"),i("v-col",[i("v-btn",{on:{click:e.uploadFile}},[e._v("上传")])],1)],1)],1)],1),i("v-divider"),i("v-form",[i("v-container",[i("v-btn",{attrs:{small:""},on:{click:e.delFile}},[e._v(" 删除 ")])],1)],1),i("v-data-table",{attrs:{dense:"","show-select":"",items:e.files,headers:e.headers,"items-per-page":5},model:{value:e.file_selected,callback:function(t){e.file_selected=t},expression:"file_selected"}})],1)],1)],1)},Me=[],be=b["b"].host,Ee={name:"fileManagerButton",data:function(){return{file_selected:[],dialog:!1,accept:".kml,.geojson,.shp",headers:[{text:"文件名称",align:"start",sortable:!1,value:"filename"},{text:"文件类型",value:"filetype"},{text:"文件路径",value:"filepath"},{text:"上传时间",value:"createtime"}],files:[],file:null}},computed:{label:function(){return"接收的文件格式："+this.accept}},methods:{delFile:function(){if(this.file_selected&&this.file_selected.length>0){var e=[];for(var t in this.file_selected)this.file_selected[t]&&this.file_selected[t].id&&(e=e.concat(this.file_selected[t].id));var i=this;this.$axios.post(be+"/d3/del",e).then((function(e){if(e&&e.data){var t=e.data;if("1"==t.state)return void i.list()}alert("删除失败")}))}},uploadFile:function(){var e=new FormData,t=this,i=function(){t.list(),t.file=null};return e.append("file",this.file),this.$axios.post(be+"/d3/upload",e,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:i})},list:function(){var e=this;this.$axios.get(be+"/d3/list").then((function(t){if(t&&t.data){var i=t.data;if("200"==i.code){var n=i.data;e.files=n}else alert("获取文件列表出错:"+i.message)}})),this.$axios.get(be+"/d3/group").then((function(t){if(t&&t.data){var i=t.data;if("200"==i.code){var n=i.data;e.$store.commit("fileList",{fileList:n})}else alert("获取树形列表出错:"+i.message)}}))}},watch:{dialog:function(e){console.log(e)}},mounted:function(){this.viewer=window.cesiumViewer,this.list()}},Ce=Ee,Oe=(i("06b2"),i("62ad")),Pe=i("8fea"),xe=i("23a7"),Le=i("4bd4"),De=i("132d"),Ae=i("0fd9"),Ie=i("71d9"),Se=i("2a7f"),Te=Object(f["a"])(Ce,ke,Me,!1,null,"a908a944",null),je=Te.exports;x()(Te,{VBtn:z["a"],VCard:J["a"],VCol:Oe["a"],VContainer:q["a"],VDataTable:Pe["a"],VDialog:Q["a"],VDivider:Z["a"],VFileInput:xe["a"],VForm:Le["a"],VIcon:De["a"],VRow:Ae["a"],VSpacer:ne["a"],VToolbar:Ie["a"],VToolbarTitle:Se["a"]});var Re=window.Cesium,Ne={data:function(){return{drawHelper:"",viewerMounted:!1,drawviewerShow:!0,imags:["./static/images/markers/1.png","./static/images/markers/2.png","./static/images/markers/3.png","./static/images/markers/4.png","./static/images/markers/5.png","./static/images/markers/6.png","./static/images/markers/7.png","./static/images/markers/8.png","./static/images/markers/5.png","./static/images/markers/6.png"],model:[{id:"model0",name:"木塔",url:"static/model/Wood_Tower.gltf"},{id:"model1",name:"人",url:"static/model/Cesium_Man.gltf"}]}},components:{cesiumContainer:v,leftContainer:me,cesiumDrawViewer:we,fileManagerButton:je},props:{},computed:{},beforeMount:function(){},mounted:function(){var e=window.cesiumViewer,t=new Re.Cesium3DTileset({url:"static/Photogrammetry/tileset.json"});this.$refs.marker.init(e),t.readyPromise.then((function(t){e.scene.primitives.add(t)}))},methods:{},watch:{}},Ge=Ne,Be=(i("8bbf"),Object(f["a"])(Ge,c,d,!1,null,null,null)),Ve=Be.exports,Ue={name:"app",components:{mapViewer:Ve}},We=Ue,Ke=(i("5c0b"),Object(f["a"])(We,s,l,!1,null,null,null)),$e=Ke.exports,He=(i("7514"),i("2f62"));i("54ba");function Ye(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=ze(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function ze(e,t){if(e){if("string"===typeof e)return Je(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Je(e,t):void 0}}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}n["default"].use(He["a"]);var Fe=new He["a"].Store({state:{fileList:[],elementList:[]},mutations:{fileList:function(e,t){console.log("fileList mutation"),e.fileList=t.fileList},elementList:function(e,t){console.log("elementList mutation"),e.elementList=t.elementList},createNewGroup:function(e,t){var i="group-"+t.newGroup.name,n=t.newGroup.name,r=t.newGroup.checked,a=t.newGroup.open,o=t.newGroup.order,s=null;s=!o||o>=e.elementList.length-1?e.elementList.splice(e.elementList.length-1,1):e.elementList.splice(o,1);var l=t.newGroup;e.elementList.push(l);var c,d=Ye(s);try{for(d.s();!(c=d.n()).done;){var u=c.value;e.elementList.push(u)}}catch(h){d.e(h)}finally{d.f()}fetch(host+"/d3/data/element/group",{method:"put",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:i,name:n,checked:r,open:a,order:o})}).then((function(e){return e.json()})).then((function(e){e.state||console.log("保存分组:"+e.message)}))},addElement:function(e,t){var i=t.ele.id,n=t.ele.name,r=t.ele.type,a=t.ele.group,o=t.ele.style;function s(e,t){var i=e.find((function(e){return e.id==t}));return!!i}var l,c=Ye(e.elementList);try{for(c.s();!(l=c.n()).done;){var d=l.value;if(s(d.children,i))return}}catch(g){c.e(g)}finally{c.f()}var u="其他";a&&(u=a);var h=e.elementList.find((function(e){return e.name==u}));h||(h={name:u,checked:0,open:0,order:1e6,children:[]},window.vue.$store.commit("createNewGroup",{newGroup:h}));var p={id:i,name:n,type:r,checked:!0};switch(h.children.push(p),r){case"marker":case"label":case"polyline":case"polygon":var m=top.markers.get(i),f=null;null!=m&&m.toGeoJson()&&(f=JSON.stringify(top.markers.get(i).toGeoJson().geometry)),fetch(host+"/d3/data/element",{method:"put",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:i,name:n,type:r,geojson:f,style:JSON.stringify(o)})}).then((function(e){return e.json()})).then((function(e){e.state||alert("操作失败:"+e.message)}));break;case"model":alert("暂不支持model类型的操作")}},updateElement:function(e,t){var i,n=t.ele.id,r=t.ele.name,a=t.ele.type,o=t.ele.group,s=t.ele.geojson,l=t.ele.style,c=!1,d=null,u=Ye(e.elementList);try{for(u.s();!(i=u.n()).done;){var h=i.value;if(h&&h.children){var p,m=Ye(h.children);try{for(m.s();!(p=m.n()).done;){var f=p.value;if(f&&f.id&&f.id===n){if(c=!0,null!=r&&(f.name=r),null!=o&&o.length>0&&o!=h.id){d=o;var g=e.elementList.find((function(e){return e.name==o})),v=e.elementList.length;if(!g){var _={name:o,checked:0,open:0,order:v,children:[]};window.vue.$store.commit("createNewGroup",{newGroup:_}),g=e.elementList.find((function(e){return e.name==o}))}g.children.push(f);var y=h.children.indexOf(f);h.children.splice(y,1)}switch(a){case"marker":case"label":case"polyline":case"polygon":default:fetch(host+"/d3/data/element",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:n,name:r,type:a,geojson:s,group:d,style:JSON.stringify(l)})}).then((function(e){return e.json()})).then((function(e){e.state||console.log("更新操作失败:"+e.message)}));break}}}}catch(w){m.e(w)}finally{m.f()}}}}catch(w){u.e(w)}finally{u.f()}c||this.commit("addElement",ele)},dropElement:function(e,t){var i,n=t.ele.id,r=Ye(e.elementList);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a&&a.children){var o,s=Ye(a.children);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(console.log(l),l&&l.id&&l.id===n){var c=a.children.indexOf(l);a.children.splice(c,1),fetch(host+"/d3/data/element",{method:"delete",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:n})}).then((function(e){return e.json()})).then((function(e){e.state||alert("操作失败:"+e.message)}))}}}catch(d){s.e(d)}finally{s.f()}}}}catch(d){r.e(d)}finally{r.f()}},dropGroup:function(e,t){var i,n=t.group.id,r=e.elementList.find((function(e){return e.id==n})),a=Ye(r.children);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.commit("dropElement",{ele:{id:o.id}})}}catch(l){a.e(l)}finally{a.f()}var s=e.elementList.indexOf(r);e.elementList.splice(s,1),fetch(host+"/d3/data/element/group",{method:"delete",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:n})}).then((function(e){return e.json()})).then((function(e){e.state||alert("操作失败:"+e.message)}))}},getters:{getFileList:function(e){return e.fileList}}}),qe=Fe,Qe=i("bc3a"),Ze=i.n(Qe);n["default"].use(a.a),n["default"].use(o["a"]);var Xe=new o["a"]({});b["b"].host;Ze.a.defaults.withCredentials=!0,n["default"].prototype.$axios=Ze.a,n["default"].config.productionTip=!1;var et=new n["default"]({vuetify:Xe,store:qe,render:function(e){return e($e)}}).$mount("#app");window.vue=et,window.showElements=function(){var e=window.vue.$children[0].$refs.mapViewer.$refs.marker.$refs.markerManager.markerManager.manager,t=window.graphicManager.manager,i=window.vue.$children[0].$refs.mapViewer.$refs.marker.$refs.layerManager.json;console.log({layers:i,graphics:t,markers:e})}},5727:function(e,t,i){},"5afc":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("ac4d"),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("8a81"),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_string_iterator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("5df3"),core_js_modules_es6_string_iterator__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_string_iterator__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("1c4c"),core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_array_from__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6762"),core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es7_array_includes__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("2fdb"),core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es6_string_includes__WEBPACK_IMPORTED_MODULE_9__),_core_GraphicManager__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("4e00"),_markerViewer__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("9361"),_core_Graphic__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("cd53"),_layerManager__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("93f3"),_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("4ab0"),shapefile__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("c26a"),_js_utils__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("9944"),jquery__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("1157"),jquery__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_17__);function _createForOfIteratorHelper(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var graphicManager=void 0,Cesium=window.Cesium,console=window.console;__webpack_exports__["a"]={name:"cesiumDrawViewer",data:function(){return{visible:!0,editMode:!1,graphicType:void 0,menuSelected:{},layerManagerVisible:!1,markerColor:"rgba(255, 255,255, 1)",fontSize:"28px",markerFont:"sans-serif",markerOptionsVisible:!1,markerOption:"",lineColor:"rgba(247,224,32,1)",lineWidth:"3px",lineWidthList:["1px","2px","3px","4px","5px","6px","8px","10px","12px"],lineStyleList:[{value:"solid",name:"实线"},{value:"dash",name:"虚线"},{value:"glow",name:"发光线"},{value:"arrow",name:"箭头线"}],lineStyle:"solid",graphicHeight:"GROUND_ADN_MODEL",heightList:[{value:"GROUND_ADN_MODEL",name:"依附地形和模型"},{value:"GROUND",name:"依附地形"},{value:"MODEL",name:"依附模型"},{value:"NONE",name:"空间线"}],outlineWidth:"3px",outlineColor:"rgba(247,224,32,1)",polygonColor:"rgba(247,224,32,0.5)",outline:!0,imags:["./static/images/markers/1.png","./static/images/markers/2.png","./static/images/markers/3.png","./static/images/markers/4.png","./static/images/markers/5.png","./static/images/markers/6.png","./static/images/markers/7.png","./static/images/markers/8.png"],fontSizeList:["10px","12px","14px","16px","18px","20px","24px","32px","64px"],fontList:["sans-serif","宋体"],fontFamily:"sans-serif",modelMode:"Highlight",modelModeList:[{value:"Highlight",name:"高亮"},{value:"Replace",name:"替换"},{value:"Mix",name:"混合"}],modelColor:"#FFFFFF",modelMixed:.5,modelSelectPanelvisible:!1,selectedModel:void 0}},computed:{defaultImage:function(){return'this.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB1UlEQVQ4T6XTMWgUQRQG4P/N3gaRSBpBEAMqrldkYyXu5VCMChZBEDxOsDIgKKSyECxTWERIYe2hRdoLeKV2RhCymwhy3E48b087C7EQtRDj7vyyg3dKDGyI087MN/97MyP4zyFF+5vNpnPEP3neZGlNlFwBoU/53rnBvn+AsPP+AFRWgUFNKVwgcVCAp4C0lJu10lTNiTGdYLLcyhF52e3uG8lUDVRnDXhagEP5YkM2pia9la0Jw413nhhzKfC9BxaI4t4aII3A9x6FcXJbBGNFZQ3jG3Yk0snjYMK7EelkHsBGMOEt7xSI4oQSxr3lin+8ngPG4MV2sQdgGPdvCviQkFsV/1jDAmu6f6c0wqWfm5grAiKd1EE0IbiaJ7VApN+egcF+KHWiCNhamgVekW4a9xdE4dsAeK716F7jLkJUNXOzmWq5/GG7vlggn4ji5BkEqzngQDYpXARQtdcErKRje2aq4+PfbaOJKcC5G/hH20NgPU7uU/AjJT47wD0Ao3+fSMgTBXwlOPvnBcoSweu/E/SuUdRFQ7YdwD6QopEnIzBtgfV2t8ySM5sSH3cF2D7oZD4jvpSAy0Wn5/MEPgGoDz/T6us3hx231KVgYSeAbTAx/Qs/Rdq4fXky6QAAAABJRU5ErkJggg=="'}},props:{attachment:void 0,extendMarkerImage:{type:Array,default:function(){return[]}},extendMarkerModel:{type:Array,default:function(){return[]}},tools:{default:void 0},viewer:{}},components:{MarkerViewer:_markerViewer__WEBPACK_IMPORTED_MODULE_11__["a"],layerManager:_layerManager__WEBPACK_IMPORTED_MODULE_13__["a"]},mounted:function(){var e=this;this.$nextTick((function(){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["f"])("drawtoolPanel","drawtoolHead"),jquery__WEBPACK_IMPORTED_MODULE_17___default()("#drawtoolPanel .el-color-picker__icon").addClass("iconfont iconcolor")})),this.viewer instanceof Cesium.Viewer?this.init(this.viewer):window.viewer instanceof Cesium.Viewer&&this.init(window.viewer),this.$nextTick((function(){e.syncColor("markerColor",e.markerColor),e.syncColor("lineColor",e.lineColor),e.syncColor("polygonColor",e.polygonColor)})),window.drawViewer=this},methods:{init:function(e){if(Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["d"])(e),!this._viewer){var t=this;this._depthTestAgainstTerrain=e.scene.globe.depthTestAgainstTerrain,this.$refs.markerManager.init(e),graphicManager=new _core_GraphicManager__WEBPACK_IMPORTED_MODULE_10__["a"](e),top.graphics=graphicManager.manager,top.graphicManager=graphicManager,this.selectedModel=this.extendMarkerModel.length?this.extendMarkerModel[0].url:void 0,this.cesiumViewer=e,this._viewer=e,document.addEventListener("addEvent",(function(e){(graphicManager.has(e.detail.gvid)||t.$refs.markerManager.has(e.detail.gvid))&&t.pushLayerManaer(e.detail.gvtype,e.detail.gvid,e.detail.gvname,e.detail.options)})),document.addEventListener("stopEdit",(function(){t.menuSelected={},t.editMode=!1,t.cesiumViewer.scene.globe.depthTestAgainstTerrain=t._depthTestAgainstTerrain,window.showElements()})),document.addEventListener("startEdit",(function(e){t.menuSelected={},t.menuSelected[e.detail.graphicType]=!0,t.setControlByEvent(e),t.editMode=!0,/.*MODEL.*/.test(t.graphicHeight)&&(t.cesiumViewer.scene.globe.depthTestAgainstTerrain=!0)})),document.addEventListener("destroyEvent",(function(e){t.$refs.layerManager.drop({id:e.detail.gvid}),t.cesiumViewer.scene.globe.depthTestAgainstTerrain=t._depthTestAgainstTerrain})),document.addEventListener("deleteEvent",(function(e){t.menuSelected={},t.editMode=!1,t.$refs.layerManager.drop({id:e.detail.gvid}),t.cesiumViewer.scene.globe.depthTestAgainstTerrain=t._depthTestAgainstTerrain}))}},syncColor:function(e,t){var i=[e];"labelColor"===e?i.push("markerColor"):"markerColor"===e&&i.push("labelColor");var n,r=jquery__WEBPACK_IMPORTED_MODULE_17___default()(".el-color-picker__icon,.el-icon-arrow-down,.iconfont iconcolor"),a=_createForOfIteratorHelper(r);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=jquery__WEBPACK_IMPORTED_MODULE_17___default()(o).parent().parent();s.length>0&&i.includes(s[0].id)&&jquery__WEBPACK_IMPORTED_MODULE_17___default()(o).css("color",t)}}catch(l){a.e(l)}finally{a.f()}},pushLayerManaer:function(e,t,i,n){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.$refs.layerManager.insertLayer(e,t,i,n)},modelThumb:function(e){return e.thumb?e.thumb:this.defaultImage},getById:function(e){return Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),graphicManager&&graphicManager.has(e)?graphicManager.get(e):this.$refs.markerManager?this.$refs.markerManager.getById(e):void 0},selectModel:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.selectedModel=e.url,this.modelSelectPanelvisible=!1,this.$refs.markerManager.setModel({uri:e.url})},setControlByEvent:function(e){if(Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),"POLYGON"===e.detail.graphicType){var t=e.detail.material,i=e.detail.outlineColor;t&&(this.polygonColor="rgba(".concat(255*t.red,",").concat(255*t.green,",").concat(255*t.blue,",").concat(t.alpha,")")),this.outline=e.detail.outline,i&&(this.outlineColor="rgba(".concat(255*i.red,",").concat(255*i.green,",").concat(255*i.blue,",").concat(i.alpha,")")),this.outlineWidth=e.detail.outlineWidth,this.graphicHeight=e.detail.heightReference}else if("POLYLINE"===e.detail.graphicType){this.graphicHeight=e.detail.heightReference,this.lineWidth=e.detail.width;var n=e.detail.material;n instanceof Cesium.PolylineDashMaterialProperty?this.lineStyle="dash":n instanceof Cesium.PolylineGlowMaterialProperty?this.lineStyle="glow":n instanceof Cesium.PolylineArrowMaterialProperty?this.lineStyle="arrow":this.lineStyle="solid",this.lineColor="rgba(".concat(255*n.getValue().color.red,",").concat(255*n.getValue().color.green,",").concat(255*n.getValue().color.blue,",").concat(n.getValue().color.alpha,")")}},stopOthers:function(){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.$refs.markerManager.stopPick(),graphicManager.destroyManager(),graphicManager.editManager=void 0},setLabel:function setLabel(){var option;Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this);try{option=eval("("+this.markerOption+")"),this.$refs.markerManager.setLabel(option)}catch(err){console.log(err)}this.markerOptionsVisible=!1},updateMarker:function(e,t,i){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),e&&(t=t||"未命名",this.$refs.layerManager.rename(null,e,t,i)),this.editMode=!1,this.menuSelected={},window.showElements()},addMarker:function(e,t,i,n){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.pushLayerManaer(i,e,t,n),i===_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].MODEL&&(this.editMode=!1,this.menuSelected={})},closeLayerManager:function(){this.layerManagerVisible=!1},exportGraphic:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),"MARKER"===e||"LABEL"===e?this.$refs.markerManager.export(e):graphicManager.export(e)},importGraphic:function(){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),document.getElementById("graphicuploadhandler").click()},importfp:function(){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this);var e=this,t=event||window.event,i=t.target.files,n=i[0].name.split(".")[1];if(0!=i.length){var r=new FileReader;"geojson"===n.toLowerCase()?(r.readAsText(i[0]),r.onload=function(){if(this.result){try{var t,i=JSON.parse(this.result).features,n=_createForOfIteratorHelper(i);try{for(n.s();!(t=n.n()).done;){var r=t.value;"POINT"===r.geometry.type.toUpperCase()?e.$refs.markerManager.import(r):graphicManager.import(r)}}catch(a){n.e(a)}finally{n.f()}}catch(o){console.log(o)}document.getElementById("graphicuploadhandler").value=""}}):"shp"===n.toLowerCase()&&(r.readAsArrayBuffer(i[0]),r.onload=function(){Object(shapefile__WEBPACK_IMPORTED_MODULE_15__["a"])(this.result).then((function(t){return t.read().then((function i(n){if(n.done)return!1;var r=n.value;return"Point"===r.geometry.type?e.$refs.markerManager.import(r):graphicManager.import(r),t.read().then(i)}))})).catch((function(e){return console.error(e.stack)}))},document.getElementById("graphicuploadhandler").value="")}},editMarker:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.editMode=!0,graphicManager.editManager&&(graphicManager.editManager.stopEdit(),graphicManager.editManager=void 0),this.menuSelected={},this.menuSelected[e]=!0},clearGraphic:function(){this.$refs.markerManager.removeAll(),graphicManager.removeAll()},deleteMarker:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),this.menuSelected["MARKER"]=!1,this.editMode=!1,this.$refs.layerManager.drop(e)},locateGraphic:function(e){if(Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),graphicManager.manager.has(e)){var t=graphicManager.manager.get(e);t.zoomTo()}else this.$refs.markerManager.zoomTo(e);this.$emit("locateEvent",e)},editGraphic:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),graphicManager.manager.has(e)?graphicManager.edit(e):this.$refs.markerManager.edit(e),this.$emit("editEvent",e)},selectGraphic:function(e,t){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),"marker"===e?this.$refs.markerManager.select(_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].MARKER,void 0,t):"label"===e?this.$refs.markerManager.select(_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].LABEL,void 0,t):"model"===e?this.$refs.markerManager.select(_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].MODEL,void 0,t):"polyline"===e?graphicManager.select(_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].POLYLINE,void 0,t):"label"===e?graphicManager.select(_core_GraphicType__WEBPACK_IMPORTED_MODULE_14__["a"].POLYGON,void 0,t):graphicManager.manager.has(e)?graphicManager.select(void 0,e,t):this.$refs.markerManager.select(void 0,e,t),this.$emit("selectEvent",e,t)},deleteGraphic:function(e){if(Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),graphicManager.manager.has(e)){var t=graphicManager.manager.get(e);t.destroy(),graphicManager.manager.delete(e)}else this.$refs.markerManager.drop(e);this.$emit("deleteEvent",e)},renameGraphic:function(e,t){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this);var i,n=/(.*?)</g.exec(t);t=/(.*?)</g.test(t)?n[1]:t,"未命名"===t&&(t=""),graphicManager.has(e)?(i=graphicManager.get(e).gvname,graphicManager.rename(e,t)):(i=this.$refs.markerManager.markerManager.get(e).gvname,this.$refs.markerManager.rename(e,t)),this.$emit("renameEvent",e,i)},menuAction:function(e){Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this);var t=["MARKER","POLYLINE","POLYGON","LABEL","MODEL"],i=this.menuSelected[e];switch(this.menuSelected={},graphicManager&&(graphicManager.tip.visible=!1),this.menuSelected[e]=!i,t.includes(e)?(this.graphicType===e?this.editMode=!this.editMode:this.editMode=!0,this.graphicType=e):this.editMode=!1,/.*MODEL*/.test(this.graphicHeight)&&(["MARKER","LABEL","MODEL","LAYER"].includes(e)||(this.cesiumViewer.scene.globe.depthTestAgainstTerrain=!0)),e){case"MARKER":this.editMode?this.$refs.markerManager.pick("marker"):this.$refs.markerManager.cancelMark();break;case"POLYLINE":this.heightList[3].name="空间线",this.editMode?(graphicManager.heightReference=this.graphicHeight,graphicManager.material=Cesium.Color.fromCssColorString(this.lineColor),graphicManager.createPolyline()):graphicManager.destroyManager();break;case"POLYGON":if(this.heightList[3].name="空间面",this.editMode){graphicManager.heightReference=this.graphicHeight;var n=_core_Graphic__WEBPACK_IMPORTED_MODULE_12__["e"].defaultStyle;n.outline=this.outline,n.outlineColor=Cesium.Color.fromCssColorString(this.outlineColor),n.outlineWidth=parseInt(this.outlineWidth),graphicManager.material=Cesium.Color.fromCssColorString(this.polygonColor),graphicManager.style=n,graphicManager.createPolygon()}else graphicManager.destroyManager();break;case"LABEL":this.editMode?this.$refs.markerManager.pick("label"):this.$refs.markerManager.cancelMark();break;case"MODEL":if(this.editMode){if(this.extendMarkerModel.length<1)throw this.editMode=!1,new Error("没有可用的模型");this.$refs.markerManager.setModel({uri:this.selectedModel}),this.$refs.markerManager.pick("model")}else this.$refs.markerManager.cancelMark()}},setLineMaterial:function(e,t){switch(Object(_js_utils__WEBPACK_IMPORTED_MODULE_16__["c"])(this),e){case"solid":graphicManager.material=t;break;case"dash":graphicManager.material=new Cesium.PolylineDashMaterialProperty({color:t});break;case"glow":graphicManager.material=new Cesium.PolylineGlowMaterialProperty({color:t});break;case"arrow":graphicManager.material=new Cesium.PolylineArrowMaterialProperty(t);break}}},watch:{fontSize:function(e){e=parseInt(e),isNaN(e)&&(e="18"),e+="px";var t=this.menuSelected["MARKER"]?this.markerFont:this.fontFamily;this.$refs.markerManager.setFont(e+" "+t)},markerColor:function(e){e&&(this.$refs.markerManager.setColor(Cesium.Color.fromCssColorString(e)),this.syncColor("markerColor",e))},graphicHeight:function(e){void 0!==e&&(graphicManager.heightReference=e)},lineColor:function(e){if(e){var t=Cesium.Color.fromCssColorString(e),i=graphicManager.editManager.material,n="solid";i instanceof Cesium.PolylineDashMaterialProperty?n="dash":i instanceof Cesium.PolylineGlowMaterialProperty?n="glow":i instanceof Cesium.PolylineArrowMaterialProperty&&(n="arrow"),this.setLineMaterial(n,t),this.syncColor("lineColor",e)}},lineStyle:function(e){if(this.lineColor){var t=Cesium.Color.fromCssColorString(this.lineColor);this.setLineMaterial(e,t)}},lineWidth:function(e){var t=parseInt(e);isNaN(t)&&(t=3),graphicManager.style={width:t}},outline:function(e){if(e){graphicManager.editManager.createOutline();var t=Cesium.Color.fromCssColorString(this.outlineColor),i=parseInt(this.outlineWidth)||3;graphicManager.editManager.outline=e,graphicManager.style={outline:!0,outlineWidth:i,outlineColor:t}}else graphicManager.editManager.removeOutline()},polygonColor:function(e){if(e){var t=Cesium.Color.fromCssColorString(e);graphicManager.material=t,this.syncColor("polygonColor",e)}},outlineColor:function(e){if(e){var t=Cesium.Color.fromCssColorString(e);graphicManager.style={outlineColor:t},this.syncColor("outlineColor",e)}},outlineWidth:function(e){var t=parseInt(e)||3;graphicManager.style={outlineWidth:t}},fontFamily:function(e){var t=parseInt(this.fontSize);isNaN(t)&&(t="18"),t+="px",this.$refs.markerManager.setFont(t+" "+e)},modelColor:function(e){if(e){var t=Cesium.Color.fromCssColorString(e);this.$refs.markerManager.setModel({color:t}),this.syncColor("modelColor",e)}},modelMode:function(e){var t=Cesium.ColorBlendMode[e.toUpperCase()];this.$refs.markerManager.setModel({mode:t})},modelMixed:function(e){this.$refs.markerManager.setModel({mixed:e})}}}},"5c0b":function(e,t,i){"use strict";i("53bd")},6626:function(e,t,i){},"8bbf":function(e,t,i){"use strict";i("483a")},9361:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{style:{left:e.winPos.x+"px",top:e.winPos.y+"px"},attrs:{id:"markerContainer"}},[i("el-dialog",{attrs:{title:e.markName+"附件",visible:e.dialogVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-upload",{ref:"upload",staticClass:"upload-class",attrs:{action:e.attachment.action,"on-remove":e.attachment.delete,"on-success":e.attachment.success,"file-list":e.attachment.fileList,"on-preview":e.attachment.download,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:function(t){return e.$refs.upload.submit()}}},[e._v("上传到服务器")])],1)],1),"marker"===e.markMode?i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],attrs:{id:"createMerkerPanel"}},[i("el-container",{directives:[{name:"show",rawName:"v-show",value:!e.selectPanel,expression:"!selectPanel"}]},[i("el-header",[i("span",[e._v("添加标记")]),e.attachment.enabled?i("i",{staticClass:"el-icon-paperclip",staticStyle:{"font-size":"16px"},attrs:{title:"附件"},on:{click:function(t){e.dialogVisible=!0}}}):e._e(),i("span",{staticClass:"closebtn iconfont iconclose",on:{click:function(t){e.visible=!1}}})]),i("el-container",{attrs:{id:"marker-panel"}},[i("el-container",[i("el-main",{staticClass:"marker-main-class"},[e._v("\n                        名称：\n                        "),i("el-input",{ref:"nameinput",nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.update(t)}},model:{value:e.markName,callback:function(t){e.markName=t},expression:"markName"}}),i("br"),e._v("描述：\n                        "),i("el-input",{attrs:{type:"textarea"},model:{value:e.markRemark,callback:function(t){e.markRemark=t},expression:"markRemark"}})],1),i("el-aside",[i("img",{attrs:{src:e.selectedImage}}),i("br"),i("a",{attrs:{href:"#",id:"imageC"},on:{click:function(t){e.selectPanel=!0}}},[e._v("更换")])])],1),i("el-footer",[i("el-button",{attrs:{type:"danger",id:"cancelbtn",plain:"",size:"mini"},on:{click:e.cancelMark}},[e._v("删除")]),i("el-button",{attrs:{type:"primary",plain:"",size:"mini",id:"submitbtn"},on:{click:e.update}},[e._v("确定")])],1)],1)],1),i("el-container",{directives:[{name:"show",rawName:"v-show",value:e.selectPanel,expression:"selectPanel"}],staticClass:"image-list-class"},e._l(e.images,(function(t,n){return i("img",{key:n,attrs:{src:t},on:{click:function(i){return e.changeHandler(t)}}})})),0)],1):e._e(),"label"===e.markMode?i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],style:{left:e.winPos.x+"px",top:e.winPos.y+"px"},attrs:{id:"createLabelPanel"}},[i("el-input",{nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.update(t)}},model:{value:e.markName,callback:function(t){e.markName=t},expression:"markName"}}),i("el-button",{attrs:{size:"mini"},on:{click:e.update}},[e._v("确定")])],1):e._e(),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"file",id:"uploadhandler",accept:".json"},on:{change:e.importMarks}})],1)},r=[],a=(i("8e6e"),i("ac6a"),i("456d"),i("75fc")),o=i("bd86"),s=(i("7f7f"),i("ac4d"),i("8a81"),i("1c4c"),i("6b54"),i("5df3"),i("f400"),i("d225")),l=i("b0b4"),c=i("cd53"),d=i("9944"),u=i("4ab0"),h=i("1157"),p=i.n(h);function m(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=f(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function f(e,t){if(e){if("string"===typeof e)return g(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){Object(o["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var y=window.Cesium,w=y.defined,k=d["e"].CVT,M=y.ScreenSpaceEventType.LEFT_CLICK,b=y.ScreenSpaceEventType.RIGHT_CLICK,E=y.ScreenSpaceEventType.MOUSE_MOVE;function C(e,t){for(var i=0,n="",r=0;r<e.length;r++)if(e.charCodeAt(r)>128?i+=2:i++,n+=e.charAt(r),i>=t)return n+"...";return n}var O=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c["a"].defaultStyle,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c["a"].defaultLabelStyle,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c["c"].defaultStyle;Object(s["a"])(this,e),t instanceof y.Viewer&&(this._viewer=t),y.defined(this._viewer)&&(this.markName="",this.markRemark="",this.markMode="marker",this.defaultImage=c["a"].defaultStyle.image,this.selectedImage=void 0,this.popWinPosition=void 0,this.markerid=void 0,this.markerOptions=i,this.labelOptions=n,this.modelOptions=r,this.cursorTip=new d["e"].CursorTip("左键标绘，右键结束.","marker-tip",t),this.cursorTip.visible=!1,this.handler=new y.ScreenSpaceEventHandler(t.canvas),this.manager=new Map,this.pickHandler=new y.ScreenSpaceEventHandler(t.canvas),this.init(this._viewer))}return Object(l["a"])(e,[{key:"init",value:function(e){if(e instanceof y.Viewer===!1)throw new Error("viewer不是一个有效的Cesium Viewer对象.");var t=this.handler,i=this,n=this.manager;e.scene.postRender.addEventListener((function(){if(w(i.popWinPosition)){var t=k.cartesian2Pixel(i.popWinPosition,e),n=document.getElementById("popContainer");if(!n)return;n.style.left=t.x-100-5+"px",n.style.top=t.y-110+"px";var r=i.popWinPosition;d["e"].pointVisibilityOnEarth(r,i._viewer)?n.style.display="block":n.style.display="none"}}));var r=function(t){var r=e.scene.pick(t.position);w(r)&&r.id instanceof y.Entity&&r.id.gvtype===u["a"].MARKER?(i.selectedMarker=n.get(r.id.gvid),i.popDiv?i.destroyPopPanle():i.createPopPanel()):i.destroyPopPanle()};t.setInputAction(r,M)}},{key:"pick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"marker",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"single";this.markMode=e;var i=this._viewer;this.cursorTip.visible=!0;var n=this.pickHandler,r=this,a=this.generateId();r.markerid=a;var o=this.manager,s=function(s){var l=k.pixel2Cartesian(s.position,i);if(y.defined(l)){var c,d;"marker"===e?(d=r.markerOptions,c=r.createMarker(l)):"label"===e?(d=r.labelOptions,c=r.createLabel(l)):"model"===e?(d=r.modelOptions,c=r.createModel(l)):(d=r.markerOptions,c=r.createMarker(l)),r.visible=!0,o.set(a,c),c.gvid=a,r.selectedMarker=c,r.activeMarker=c,r.cursorTip.visible=!1,"model"===e&&(r.activeMarker=void 0),"single"===t&&(n.removeInputAction(M),n.removeInputAction(b));var u=new CustomEvent("marker-add",{detail:{id:c.gvid,name:c.gvname||"未命名",description:c.description,type:c.gvtype,position:k.toDegrees(l,r._viewer),options:d}});window.dispatchEvent(u),c=void 0}},l=function(){n.removeInputAction(M),n.removeInputAction(b),r.cursorTip.visible=!1;var e=r.activeMarker?r.activeMarker.id:void 0,t=new CustomEvent("marker-delete",{detail:{id:e}});window.dispatchEvent(t),r.activeMarker=void 0},c=function(e){r.cursorTip.updatePosition(e.endPosition)};n.setInputAction(l,b),n.setInputAction(s,M),n.setInputAction(c,E)}},{key:"get",value:function(e){if(this.has(e))return this.manager.get(e)}},{key:"has",value:function(e){return!!this.manager&&this.manager.has(e)}},{key:"createMarker",value:function(e,t){var i=this.labelOptions,n=this.markerOptions;t&&(n=JSON.parse(t));var r=new c["a"](this._viewer,_(_({},n),{},{position:e}),i);return r}},{key:"changeHandler",value:function(e){this.selectedImage=e,this.activeMarker.updateImage(this.selectedImage)}},{key:"panelPosition",value:function(){if(this.activeMarker){if("marker"===this.markMode){var e=this.activeMarker.graphic.position.getValue(),t=k.cartesian2Pixel(e,this._viewer),i=t.x>170?t.x-170:t.x+10,n=t.y>210?t.y-240:t.y+50;return{x:i,y:n}}var r=this.activeMarker.graphic.position.getValue(),a=k.cartesian2Pixel(r,this._viewer),o=a.x+10,s=a.y-25;return{x:o,y:s}}return{x:0,y:0}}},{key:"createLabel",value:function(e){var t=this.labelOptions;t.position=e;var i=new c["b"](this._viewer,t);return i}},{key:"createModel",value:function(e){var t=this.modelOptions;t.position=e;var i=new c["c"](this._viewer,t);return i}},{key:"removeEventListener",value:function(){var e=this.pickHandler;e&&(e.isDestroyed()||(e.removeInputAction(M),e.removeInputAction(b),e.removeInputAction(E)))}},{key:"stopPick",value:function(){if(this.removeEventListener(),this.activeMarker){this.activeMarker.destroy();var e=new CustomEvent("marker-delete",{detail:{id:this.activeMarker.gvid}});window.dispatchEvent(e)}this.activeMarker=void 0,this.cursorTip.visible=!1}},{key:"zoomTo",value:function(e){this.manager.has(e)&&this.manager.get(e).zoomTo()}},{key:"edit",value:function(e){var t=this.manager;if(t.has(e)){var i=t.get(e);this.activeMarker=i,i.startEdit(),i.gvtype!==u["a"].MARKER&&i.gvtype!==u["a"].LABEL||(this.markName=this.activeMarker.gvname,this.markRemark=this.activeMarker.description,this.visible=!0);var n=this.panelPosition(),r=new CustomEvent("marker-edit",{detail:{name:this.markName,remark:this.markRemark,type:this.activeMarker.type,pos:n}});window.dispatchEvent(r)}}},{key:"drop",value:function(e){var t=this.manager.get(e);t&&t.destroy(),this.manager.delete(e)}},{key:"rename",value:function(e,t){var i=this.manager.get(e);i.gvname=t}},{key:"select",value:function(e,t,i){if(w(t)){var n=this.manager.get(t);w(n)&&(n.show=i)}if(w(e)){var r,a=this.manager.values(),o=m(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.gvtype===e&&(s.show=i)}}catch(l){o.e(l)}finally{o.f()}}}},{key:"destroyPopPanle",value:function(){this.popDiv&&(p()(this.popDiv).remove(),this.popDiv=void 0)}},{key:"destroy",value:function(){this.removeAll(),this.destroyPopPanle(),this.pickHandler.isDestroyed()||this.pickHandler.destroy(),this.handler.isDestroyed()||this.handler.destroy(),this._viewer=void 0,this.labelOptions=void 0,this.markerOptions=void 0,this.modelOptions=void 0}},{key:"createPopPanel",value:function(){if(w(this.selectedMarker)){this.popDiv&&this.destroyPopPanle();var e=document.createElement("div");e.id="popContainer",e.className="marker-popWin-class";var t=this.selectedMarker.position;this.popWinPosition=t;var i,n=k.cartesian2Degrees(t,this._viewer);e.style.display="none",i=document.createElement("span"),i.title=this.selectedMarker.description,i.innerText="描述:"+C(this.selectedMarker.description||"暂无",14);var r=document.createElement("span");r.innerText="纬度:"+n.lon.toFixed(2)+"  纬度:"+n.lat.toFixed(2);var a=document.createElement("div");a.className="arrow";var o=document.createElement("span");o.className="iconfont iconclose closebtn";var s=this;o.onclick=function(){p()(s.popDiv).remove(),s.popDiv=void 0},e.appendChild(o),i&&e.appendChild(i),e.appendChild(r),e.appendChild(a),this.popDiv=e,this._viewer.container.appendChild(this.popDiv)}}},{key:"import",value:function(e){if("POINT"!==e.geometry.type.toUpperCase())throw new Error("无效的数据类型.");var t,i=this.generateId();if(e.properties.gvtype===u["a"].LABEL){var n,r=c["b"].defaultStyle;r.position=(n=y.Cartesian3).fromDegrees.apply(n,Object(a["a"])(e.geometry.coordinates)),r.text=e.properties.name,t=new c["b"](this._viewer,r)}else{var o={lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],height:e.geometry.coordinates[2]};t=c["a"].fromDegrees(this._viewer,o)}t.gvname=e.properties.name,t.gvid=i,this.manager.set(i,t);var s=new CustomEvent("marker-add",{detail:{id:t.gvid,name:t.gvname||"未命名",type:t.gvtype,description:t.description,properties:e.properties,position:{lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],height:e.geometry.coordinates[2]}}});window.dispatchEvent(s)}},{key:"addMarker",value:function(e){this.manager.set(e.gvid,e)}},{key:"export",value:function(e){var t,i=this.manager.values(),n={type:"FeatureCollection",name:"graphic",crs:{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}},features:[]},r=m(i);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.type===e&&n.features.push(a.toGeoJson())}}catch(s){r.e(s)}finally{r.f()}var o=new Blob([JSON.stringify(n)],{type:""});window.saveAs(o,e+parseInt(y.getTimestamp())+".geojson")}},{key:"font",get:function(){if(this.activeMarker)return this.activeMarker.font},set:function(e){this.labelOptions.font=e,this.activeMarker&&(this.activeMarker.font=e)}},{key:"color",set:function(e){this.labelOptions.fillColor=e,this.activeMarker&&(this.activeMarker.color=e)}},{key:"label",set:function(e){for(var t=Object.keys(e),i=0,n=t;i<n.length;i++){var r=n[i];this.labelOptions[r]=e[r]}this.activeMarker&&this.activeMarker.setLabel(this.labelOptions)}},{key:"model",set:function(e){this.modelOptions=_(_({},this.modelOptions),e),this.activeMarker&&(e.uri&&(this.activeMarker.uri=e.uri),e.color&&(this.activeMarker.color=e.color),void 0!=e.mode&&(this.activeMarker.model=e.mode),void 0!=e.mixed&&(this.activeMarker.mixed=e.mixed))}},{key:"removeAll",value:function(){var e,t=this.manager.values(),i=m(t);try{for(i.s();!(e=i.n()).done;){var n=e.value;n.remove(),n.destroy()}}catch(r){i.e(r)}finally{i.f()}this.manager.clear()}},{key:"cancelMark",value:function(){this.activeMarker&&this.activeMarker.destroy(),this.activeMarker=void 0,this.cursorTip.visible=!1;var e=new CustomEvent("marker-delete",{detail:{id:this.markerid}});window.dispatchEvent(e),this.markName="",this.markRemark="",this.manager.delete(this.markerid),this.markerid=void 0,this.removeEventListener()}},{key:"update",value:function(e,t){this.markName=e,this.markRemark=t,this.activeMarker.updateText(this.markName,this.markRemark),this.cursorTip.visible=!1,this.activeMarker.stopEdit();var i=this.markerOptions,n=new CustomEvent("marker-update",{detail:{id:this.activeMarker.gvid,name:this.activeMarker.gvname,description:this.activeMarker.description,position:k.toDegrees(this.activeMarker.position,this._viewer),options:i}});window.dispatchEvent(n),this.activeMarker=void 0,this.removeEventListener()}},{key:"generateId",value:function(){return(1e7*Math.random()).toString(16).substr(0,4)+"-"+(new Date).getTime()+"-"+Math.random().toString().substr(2,5)}}]),e}();function P(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function x(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?P(Object(i),!0).forEach((function(t){Object(o["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):P(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var L={name:"cesiumMarkerViewer",data:function(){return{visible:!1,selectPanel:!1,markName:"",markRemark:"",images:[],markMode:"",winPos:{x:0,y:0},dialogVisible:!1,fileList:[]}},computed:{},components:{},props:{extendImage:{type:Array,default:function(){return[]}},attachment:{default:function(){return{enabled:!1,method:""}}}},directives:{focus:{bind:function(e){e.focus()},updated:function(e){e.focus()},inserted:function(e){e.focus()}}},mounted:function(){var e=this;window.addEventListener("marker-edit",(function(t){var i=t.detail.type;e.visible=!0,e.markName=t.detail.name,e.markRemark=t.detail.remark,e.winPos=x({},t.detail.pos),e.$emit("editEvent",i)})),window.addEventListener("marker-add",(function(t){e.winPos=e.markerManager.panelPosition(),e.visible=!0,e.$emit("addEvent",t.detail.id,t.detail.name,t.detail.type,t.detail.options)})),window.addEventListener("marker-delete",(function(t){e.visible=!1,e.$emit("deleteEvent",t.detail.id),e.markName="",e.markRemark=""})),window.addEventListener("marker-update",(function(t){e.$emit("updateEvent",t.detail.id,t.detail.name,t.detail.options),e.markName="",e.markRemark=""})),this.$nextTick((function(){d["e"].moveDiv("markerContainer")}))},methods:{init:function(e){this._viewer||(Object(d["d"])(e),this._viewer=e,!this.markerManager&&(this.markerManager=new O(e)),this.images=[this.markerManager.defaultImage].concat(Object(a["a"])(this.extendImage)),this.selectedImage=this.markerManager.defaultImage,top.markers=this.markerManager.manager,top.markerManager=this.markerManager)},pick:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"marker",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"single";if(Object(d["c"])(this),this.markerManager)return this.markMode=e,this.markerManager.pick(e,t)},createMarker:function(e){if(this.markerManager)return this.markerManager.createMarker(e)},panelPosition:function(){if(this.markerManager)return this.markerManager.panelPosition()},createLabel:function(e){if(this.markerManager)return this.markerManager.createLabel(e)},createModel:function(e){if(this.markerManager)return this.markerManager.createLabel(e)},removeEventListener:function(){if(this.markerManager)return this.markerManager.removeEventListener()},stopPick:function(){this.markerManager&&this.markerManager.stopPick()},zoomTo:function(e){this.markerManager&&this.markerManager.zoomTo(e)},edit:function(e){this.markerManager&&this.markerManager.edit(e)},drop:function(e){this.markerManager&&this.markerManager.drop(e)},rename:function(e,t){this.markerManager&&this.markerManager.rename(e,t)},select:function(e,t,i){this.markerManager&&this.markerManager.select(e,t,i)},destroyPopPanle:function(){this.markerManager&&this.markerManager.destroyPopPanle()},createPopPanel:function(){this.markerManager&&this.markerManager.createPopPanel()},import:function(e){this.markerManager&&(this.markerManager.createPopPanel(),this.markerManager.import(e))},export:function(e){this.markerManager&&this.markerManager.export(e)},setFont:function(e){this.markerManager&&(this.markerManager.font=e)},getFont:function(){if(this.activeMarker)return this.markerManager.font},setColor:function(e){this.markerManager&&(this.markerManager.color=e)},setLabel:function(e){this.markerManager&&(this.markerManager.label=e)},setModel:function(e){this.markerManager&&(this.markerManager.model=e)},removeAll:function(){this.markerManager&&this.markerManager.removeAll()},cancelMark:function(){this.markerManager&&this.markerManager.cancelMark()},update:function(){this.markerManager&&(this.markerManager.update(this.markName,this.markRemark),this.visible=!1)},changeHandler:function(e){this.markerManager&&(this.markerManager.changeHandler(e),this.markerManager.markerOptions.image=e,this.selectedImage=e),this.selectPanel=!1},generateId:function(){if(this.markerManager)return this.markerManager.generateId()},getById:function(e){if(this.has(e))return this.markerManager.get(e)},has:function(e){return!!this.markerManager&&this.markerManager.has(e)},importMarks:function(){}},watch:{}},D=L,A=(i("cd56"),i("2877")),I=Object(A["a"])(D,n,r,!1,null,"3bd39f48",null);t["a"]=I.exports},"93f3":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"layer-manager-box",attrs:{id:"layer-manager-box"}},[i("div",{staticClass:"layer-manager-header",attrs:{id:"layer-manager-header"}},[i("i",{staticClass:"iconfont iconclose1"}),i("span",[e._v("标绘清单")]),i("span",{staticClass:"closebtn iconfont iconclose",on:{click:e.closeLayerManaer}})]),i("div",{staticClass:"layer-manager-tools"},[i("span",{staticClass:"el-dropdown-link",on:{click:e.importHandler}},[e._m(0)]),i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.exportHandler}},[i("span",{staticClass:"el-dropdown-link"},[i("i",{staticClass:"iconfont iconexport action-icon-class"},[i("span",[e._v("导出")])])]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{staticClass:"iconfont iconmarker",attrs:{command:"MARKER"}},[e._v("标记")]),i("el-dropdown-item",{staticClass:"iconfont iconpolyline",attrs:{command:"POLYLINE"}},[e._v("线")]),i("el-dropdown-item",{staticClass:"iconfont iconpolygon",attrs:{command:"POLYGON"}},[e._v("多边形")]),i("el-dropdown-item",{staticClass:"iconfont iconlabel",attrs:{command:"LABEL"}},[e._v("书签")])],1)],1),i("i",{staticClass:"iconfont iconremove action-icon-last-class",on:{click:e.removeAll}},[i("span",[e._v("清空")])])],1),i("div",{staticClass:"graphic-draw-layer-manager-class",attrs:{id:"layerTree"}},[i("el-tree",{ref:"tree",attrs:{data:e.json,"show-checkbox":"","node-key":"id","default-expanded-keys":["marker","polyline","polygon"]},on:{check:e.checkAction},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var n=t.data;return i("span",{staticClass:"custom-tree-node"},[i("i",{staticClass:"action-item",class:n.icon}),n.edit?i("el-input",{nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.renameAction(n)}},model:{value:e.newName,callback:function(t){e.newName=t},expression:"newName"}}):i("span",{staticClass:"node-name action-item"},[e._v(e._s(n.text))]),n.children?e._e():i("span",{staticClass:"action-class"},e._l(e.tools,(function(e){return i("i",{key:e.id,staticClass:"iconfont action-item",class:[e.icon],attrs:{title:e.text},on:{click:function(t){return e.action(n)}}})})),0)],1)}}])})],1)])},r=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("i",{staticClass:"iconfont iconimport action-icon-class"},[i("span",[e._v("导入")])])}],a=(i("ac4d"),i("8a81"),i("1c4c"),i("7f7f"),i("6b54"),i("8e6e"),i("456d"),i("bd86"));i("6762"),i("2fdb"),i("ac6a"),i("5df3"),i("f400");function o(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=s(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,l=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){l=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(l)throw a}}}}function s(e,t){if(e){if("string"===typeof e)return l(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){Object(a["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var u={data:function(){return{markerTree:new Map,polylineTree:new Map,polygonTree:new Map,labelTree:new Map,modelTree:new Map,renameNodeStatus:!1,checked:[],newName:"",items:{},json:[{id:"marker",text:"标记",type:"marker",icon:"iconfont icon-lujing",children:[]},{id:"polyline",text:"线",type:"polyline",icon:"iconfont iconpolyline",children:[]},{id:"polygon",text:"多边形",type:"polygon",icon:"iconfont iconpolygon",children:[]},{id:"label",text:"文字",type:"label",icon:"iconfont iconlabel",children:[]},{id:"model",icon:"iconfont iconmodel",text:"模型",type:"model",children:[]}],defaultTools:{locate:{text:"定位",icon:"iconlocate",action:this.locate},rename:{text:"重命名",icon:"iconrename",action:this.rename},edit:{text:"编辑",icon:"iconedit",action:this.edit},drop:{text:"删除",icon:"iconremove",action:this.drop}}}},props:{tools:{default:function(){return this.defaultTools}}},mounted:function(){},computed:{},methods:{checkAction:function(e,t){t.checkedKeys.includes(e.id)?this.$emit("select",e.id,!0):this.$emit("select",e.id,!1)},locate:function(e){this.$emit("locate",e.id)},operateElement:function(e,t,i,n,r){"0"===n||0===n?n="marker":"1"===n||1===n?n="polyline":"2"===n||2===n?n="polygon":"3"!==n&&3!==n||(n="label"),"removeAll"===n&&this.removeAllElements();var a=d({},r);switch(delete a.positions,e){case"add":this.$store.commit("addElement",{ele:{id:t,name:i,type:n,style:a}});break;case"update":this.$store.commit("updateElement",{ele:{id:t,name:i,type:n,style:a}});break;case"drop":this.$store.commit("dropElement",{ele:{id:t,name:i,type:n}});break}},rename:function(e,t,i,n){if(e)this.$set(e,"edit",!0),this.newName=e.text;else{var r,a=o(this.json);try{for(a.s();!(r=a.n()).done;){var s,l=r.value,c=o(l.children);try{for(c.s();!(s=c.n()).done;){var d=s.value,u=l.id;d.id===t&&(d.text=i,this.operateElement("update",t,i,u,n))}}catch(h){c.e(h)}finally{c.f()}}}catch(h){a.e(h)}finally{a.f()}}},renameAction:function(e){e.edit=!1,this.$emit("rename",e.id,this.newName),e.text=this.newName},edit:function(e){this.$emit("edit",e.id)},drop:function(e){var t=this;if(e){this.$emit("delete",e.id);var i=this.checked.indexOf(e.id);e.id>-1&&this.checked.splice(i,1),this.$nextTick((function(){t.$refs.tree.setCheckedKeys(t.checked)}));var n,r=o(this.json);try{for(r.s();!(n=r.n()).done;){var a,s=n.value,l=0,c=o(s.children);try{for(c.s();!(a=c.n()).done;){var d=a.value;if(d.id===e.id){s.children.splice(l,1);break}l++}}catch(u){c.e(u)}finally{c.f()}}}catch(u){r.e(u)}finally{r.f()}}},removeAll:function(){var e=this;this.$emit("clear");var t,i=o(this.json);try{for(i.s();!(t=i.n()).done;){var n=t.value;n.children.splice(0),this.operateElement("removeAll",null,null,null)}}catch(r){i.e(r)}finally{i.f()}this.$nextTick((function(){e.$refs.tree.setCheckedKeys([])}))},insertLayer:function(e,t,i,n){var r=this;i=i||"未命名",this.json[e].children.push({id:t,text:i,icon:"el-icon-document"}),this.checked.push(t),this.$nextTick((function(){r.$refs.tree.setCheckedKeys(r.checked)})),this.operateElement("add",t,i,e,n)},exportHandler:function(e){this.$emit("export",e)},importHandler:function(e){this.$emit("import",e)},closeLayerManaer:function(){this.$emit("close")}}},h=u,p=(i("ea24"),i("002b"),i("2877")),m=Object(p["a"])(h,n,r,!1,null,"04e9be58",null);t["a"]=m.exports},9944:function(e,t,i){"use strict";i.d(t,"f",(function(){return f})),i.d(t,"a",(function(){return m})),i.d(t,"c",(function(){return b})),i.d(t,"d",(function(){return M})),i.d(t,"b",(function(){return O}));i("6b54"),i("2397");var n=i("4e2b"),r=i("308d"),a=i("6bb5"),o=i("f28b"),s=i("d225"),l=i("b0b4"),c=(i("34ef1"),i("28a5"),i("1157")),d=i.n(c);function u(e){var t=h();return function(){var i,n=Object(a["a"])(e);if(t){var o=Object(a["a"])(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Object(r["a"])(this,i)}}function h(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var p=window.Cesium,m=function(){function e(){}return e.cartesian2Pixel=function(e,t){return p.SceneTransforms.wgs84ToWindowCoordinates(t.scene,e)},e.pixel2Cartesian=function(t,i){return i.terrainProvider instanceof p.EllipsoidTerrainProvider?e.pixel2Cartesian1(t,i):e.pixel2Cartesian2(t,i)},e.pixel2Cartesian1=function(e,t){var i=t.camera.pickEllipsoid(e,t.scene.globe.ellipsoid);return i},e.pixel2Cartesian2=function(e,t){var i=t.camera.getPickRay(e),n=t.scene.globe.pick(i,t.scene);return n},e.cartesian2Radians=function(e,t){var i=t.scene.globe.ellipsoid||p.Ellipsoid.WGS84,n=p.Cartographic.fromCartesian(e,i),r=n.longitude,a=n.latitude,o=n.height;return{lon:r,lat:a,height:o}},e.cartesian2Degrees=function(t,i){var n=e.cartesian2Radians(t,i),r=p.Math.toDegrees(n.lon),a=p.Math.toDegrees(n.lat),o=n.height;return{lon:r,lat:a,height:o}},e.degrees2Cartesian=function(e){var t=p.Cartesian3.fromDegrees(e.lon,e.lat,e.height);return t},e.radians2Cartesian=function(e){return p.Cartesian3.fromRadians(e.lon,e.lat,e.height)},e.pixel2Degrees=function(t,i){var n=e.pixel2Cartesian(t,i);if(p.defined(n))return e.cartesian2Degrees(n,i)},e.pixel2Radians=function(t,i){var n=e.pixel2Cartesian(t,i);if(p.defined(n))return e.cartesian2Radians(n,i)},e.toDegrees=function(t,i){return t instanceof p.Cartesian3?e.cartesian2Degrees(t,i):t instanceof p.Cartesian2?e.pixel2Degrees(t,i):void 0},e.toRadians=function(t,i){return t instanceof p.Cartesian3?e.cartesian2Radians(t,i):t instanceof p.Cartesian2?e.pixel2Radians(t,i):void 0},e.toPixel=function(t,i){if(t instanceof p.Cartesian)return e.cartesian2Pixel(t,i)},e}();function f(e,t){if(!d()("#"+e))throw new Error("请指定要操作的元素");t||(t=e),d()("#"+t).mousedown((function(i){d()("#"+t).css("cursor","move");var n=d()("#"+e).position(),r=i.pageX-n.left,a=i.pageY-n.top;d()(document).bind("mousemove",(function(i){d()("#"+t).css("cursor","move"),d()("#"+e).stop();var n=i.pageX-r,o=i.pageY-a;d()("#"+e).animate({left:n+"px",top:o+"px"},10)}))})),d()(document).mouseup((function(){d()("#"+t).css("cursor","default"),d()(this).unbind("mousemove")}))}function g(e){var t={},i=e.scene,n=i.globe.ellipsoid,r=i.canvas,a=e.camera.pickEllipsoid(new p.Cartesian2(0,0),n),o=e.camera.pickEllipsoid(new p.Cartesian2(r.width,r.height),n);if(a&&o){var s=n.cartesianToCartographic(a),l=n.cartesianToCartographic(o);t.xmin=p.Math.toDegrees(s.longitude),t.ymax=p.Math.toDegrees(s.latitude),t.xmax=p.Math.toDegrees(l.longitude),t.ymin=p.Math.toDegrees(l.latitude)}else if(!a&&o){var c=null,d=0;do{d<=r.height?d+=10:r.height,c=e.camera.pickEllipsoid(new p.Cartesian2(0,d),n)}while(!c);var u=n.cartesianToCartographic(c),h=n.cartesianToCartographic(o);t.xmin=p.Math.toDegrees(u.longitude),t.ymax=p.Math.toDegrees(u.latitude),t.xmax=p.Math.toDegrees(h.longitude),t.ymin=p.Math.toDegrees(h.latitude)}return t.height=Math.ceil(e.camera.positionCartographic.height),t}var v=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new p.Cartesian3,n=e.scene,r=e.camera,a=new p.Cartographic,o=new p.Ray;if(n.mode!==p.SceneMode.MORPHING&&(p.defined(e.trackedEntity)?i=e.trackedEntity.position.getValue(e.clock.currentTime,i):(o.origin=r.positionWC,o.direction=r.directionWC,i=n.globe.pick(o,n,i)),p.defined(i)))return n.mode===p.SceneMode.SCENE2D||n.mode===p.SceneMode.COLUMBUS_VIEW?(i=r.worldToCameraCoordinatesPoint(i,i),t&&(i=n.globe.ellipsoid.cartographicToCartesian(n.mapProjection.unproject(i,a),i))):t||(i=r.worldToCameraCoordinatesPoint(i,i)),i},_=function(e,t){e.render(),t&&""!=t||(t=(new Date).toLocaleString()+".png");var i=t.split(".")[1];y(t,e.scene.canvas.toDataURL("image/%s"%i))},y=function(e,t){var i=document.createElement("a"),n=a(t),r=document.createEvent("HTMLEvents");function a(e){for(var t=e.split(";base64,"),i=t[0].split(":")[1],n=window.atob(t[1]),r=n.length,a=new Uint8Array(r),o=0;o<r;++o)a[o]=n.charCodeAt(o);return new Blob([a],{type:i})}r.initEvent("click",!0,!0),i.download=e,i.href=URL.createObjectURL(n),i.click()},w=function(e,t){e.response?t(e.response.data):e.request?t(e.request):t(e.message)},k=function(){function e(t,i,n){Object(s["a"])(this,e);var r=document.createElement("div");r.id=i||"cursor-tip",r.className="cursor-tip-class",r.innerHTML=t,document.body.appendChild(r),this.ele=r,this._visible=!0;var a=this;n instanceof p.Viewer&&n.screenSpaceEventHandler.setInputAction((function(e){a.updatePosition(e.endPosition)}),p.ScreenSpaceEventType.MOUSE_MOVE)}return Object(l["a"])(e,[{key:"updatePosition",value:function(e){this.ele.style.left=e.x+10+"px",this.ele.style.top=e.y+10+"px"}},{key:"updateText",value:function(e){this.ele.innerHTML=e}},{key:"visible",get:function(){return this._visible},set:function(e){this._visible=e,this.ele.style.display=e?"block":"none"}}]),e}();function M(e){if(e instanceof p.Viewer===!1)throw new E(e+"不是一个有效的Cesium Viewer对象")}function b(e,t){if(e&&e._viewer instanceof p.Viewer===!1)throw new E("组件尚未初始化"+e._uid);if(!e&&!window.Cesium.defined(t))throw new E("组件尚未初始化")}var E=function(e){Object(n["a"])(i,e);var t=u(i);function i(e){var n;return Object(s["a"])(this,i),n=t.call(this,e),n.name="GVError",n}return i}(Object(o["a"])(Error));function C(e,t){return new p.EllipsoidalOccluder(p.Ellipsoid.WGS84,t.camera.position).isPointVisible(e)}var O={scheme:"http",ip:"localhost",post:"8081",host:"http://localhost:8081"};t["e"]={moveDiv:f,errroCatch:w,currentExtent:g,viewCenter:v,saveCurViewerImage:_,downloadFile:y,CVT:m,CursorTip:k,pointVisibilityOnEarth:C,SERVER:O}},9945:function(e,t,i){},a28e:function(e,t,i){"use strict";i("6626")},b3f0:function(e,t,i){},bd73:function(e,t,i){"use strict";i("5553")},c6cc:function(e,t,i){"use strict";i("36e9")},cd53:function(e,t,i){"use strict";i.d(t,"d",(function(){return C})),i.d(t,"f",(function(){return O})),i.d(t,"e",(function(){return P})),i.d(t,"b",(function(){return x})),i.d(t,"a",(function(){return E})),i.d(t,"c",(function(){return L}));i("8e6e"),i("2397"),i("ac4d"),i("8a81"),i("5df3"),i("1c4c"),i("7f7f"),i("6b54");var n=i("75fc"),r=(i("ac6a"),i("456d"),i("013f")),a=i("4e2b"),o=i("308d"),s=i("6bb5"),l=i("bd86"),c=i("d225"),d=i("b0b4"),u=i("4ab0"),h=i("9944");function p(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?p(Object(i),!0).forEach((function(t){Object(l["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function f(e){var t=g();return function(){var i,n=Object(s["a"])(e);if(t){var r=Object(s["a"])(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Object(o["a"])(this,i)}}function g(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function v(e,t){var i;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=_(e))||t&&e&&"number"===typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}function _(e,t){if(e){if("string"===typeof e)return y(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var w=window.Cesium,k=w.defined,M=window.console,b=function(){function e(t){if(Object(c["a"])(this,e),t instanceof w.Viewer===!1)throw new Error("viewer不是一个有效的Cesium Viewer对象.");this.viewer=t,this._type=void 0,this._gvtype=void 0,this._gvid=void 0,this._name=void 0,this._attachment=[]}return Object(d["a"])(e,[{key:"attachment",get:function(){return this._attachment},set:function(e){this._attachment=e}},{key:"type",get:function(){return this._type}},{key:"gvtype",get:function(){return this._gvtype},set:function(e){this._gvtype=e}},{key:"gvid",get:function(){return this._gvid},set:function(e){this._gvid=e,this.graphic&&(this.graphic.gvid=this._gvid)}},{key:"gvname",get:function(){return this._name},set:function(e){this._name=e,this.graphic&&(this.graphic.gvname=this.gvname,this.graphic.label&&(this.graphic.label.text=e))}},{key:"show",get:function(){return!!this.graphic&&this.graphic.show},set:function(e){this.graphic&&(this.graphic.show=e)}},{key:"zoomTo",value:function(){this.graphic&&this.viewer.flyTo(this.graphic)}},{key:"coordinates",value:function(){if(this.position instanceof w.Cartesian3){var e=h["a"].cartesian2Degrees(this.position,this.viewer);return[e.lon,e.lat,e.height]}if(this.positions instanceof Array){var t,i=[],n=v(this.positions);try{for(n.s();!(t=n.n()).done;){var r=t.value,a=h["a"].cartesian2Degrees(r,this.viewer);i.push([a.lon,a.lat,a.height])}}catch(o){n.e(o)}finally{n.f()}return"POLYLINE"===this.type?i:[i]}}},{key:"toGeoJson",value:function(){var e={MARKER:"Point",POLYLINE:"LineString",POLYGON:"POLYGON",LABEL:"Point"};return{type:"Feature",properties:{name:this.gvname,gvtype:this.gvtype},geometry:{type:e[this.type],coordinates:this.coordinates()}}}}]),e}(),E=function(e){Object(a["a"])(i,e);var t=f(i);function i(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.defaultLabelStyle;Object(c["a"])(this,i),a=t.call(this,e),a.viewer=e,a._type="MARKER",a.gvtype=u["a"].MARKER,a.position=n.position,n.image=n.image||i.defaultStyle.image,o.text=n.label,a.labelOptions=o;var s=Object(r["a"])(a);return a.options={gvname:a._name,gvtype:a.gvtype,gvid:a.gvid,position:s.position,billboard:n,label:o},a.graphic=void 0,a.name="",a.description="",a.create(),a}return Object(d["a"])(i,[{key:"text",get:function(){return this.graphic.label.text},set:function(e){this.graphic.label.text=e,this.gvname=e}},{key:"font",get:function(){return this.graphic.label.font.getValue()},set:function(e){this.graphic.label.font=e}},{key:"color",get:function(){return this.graphic.label.fillColor},set:function(e){this.graphic.label.fillColor=e}},{key:"setLabel",value:function(e){if(this.graphic)for(var t=Object.keys(e),i=0,n=t;i<n.length;i++){var r=n[i];this.graphic.label[r]=e[r]}}},{key:"create",value:function(){this.graphic=this.viewer.entities.add(this.options)}},{key:"remove",value:function(){this.viewer&&this.viewer.entities.remove(this.graphic),this.graphic=void 0}},{key:"updateText",value:function(e,t){this.graphic&&(this.graphic.label.text=e,this.name=e,this.description=t,this.gvname=e)}},{key:"updateImage",value:function(e){this.graphic&&(void 0===e?(this.graphic.label.pixelOffset=void 0,this.graphic.billboard.image=void 0):(this.graphic.label.pixelOffset=this.labelOptions.pixelOffset,this.graphic.billboard.image=e))}},{key:"updatePosition",value:function(e){this.position=e}},{key:"stopEdit",value:function(){this.graphic&&this.graphic.position&&(this.graphic.position=new w.ConstantProperty(this.position))}},{key:"startEdit",value:function(){var e=this;this.graphic&&(this.graphic.position=new w.CallbackProperty((function(){return e.position}),!1))}},{key:"destroy",value:function(){this.remove(),this.viewer=void 0,this.options=void 0,this.position=void 0}}],[{key:"fromDegrees",value:function(e,t){var n=i.defaultStyle;return n.position=w.Cartesian3.fromDegrees(t.lon,t.lat,t.height),new i(e,n)}},{key:"fromRadians",value:function(e,t){var n=i.defaultStyle;return n.position=w.Cartesian3.fromRadians(t.lon,t.lat,t.height),new i(e,n)}}]),i}(b);Object(l["a"])(E,"defaultStyle",{image:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJEN0VBRDA0MzJCRTExRUE5MjY2QTg3OUVFNjUyQzhCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJEN0VBRDA1MzJCRTExRUE5MjY2QTg3OUVFNjUyQzhCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkQ3RUFEMDIzMkJFMTFFQTkyNjZBODc5RUU2NTJDOEIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkQ3RUFEMDMzMkJFMTFFQTkyNjZBODc5RUU2NTJDOEIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6qzlgwAAADR0lEQVR42uxXTUhUURQ+88aZ93JSZyiDCCkt+0VLtGzRn/QntotMoqBEol1Ui9JVtNCsoKJNSFgQREjRKiXF/mxToIQK2YBZIRKlaE1pb+Y5M33n+dRJfTN3ZoLZdOG7986dc75z5v6cc8YSDAYpkU2iBLeEO5AUpfxy4BCwHVgLLDTWh4B3wEvgPvBBlNAy1x1w3fP89XnkcOoyDJeBA6wTgZMJHwJnwfNpBk/0DkCpFEM9kKL6iR591qixX6OukQB9+x3QZRbNkyjXJdG+DBvtX2ojxaov/wQqwPUgZgegUIHhFss19o9TVYdK/aOBsD8/wyHRxXwFziRN7sZx8NWbOWB6CSFchKGOjZ9/q9KRtrGIxrmxDMuyjnFcdQaX+B3g7QZ6gCWXur1U2+WN6YZX5sp0Lkfm6YBxaT2iO3CKjbcP+elKtzfmJ8a6zMFcwGnRHVB4J/mJFbeM0ptBf1zvvDDdSk/2OCafagagRtqBvWy8c9gft3FuzMFcRswoFjmC3dy1DIybktqhVVugUF9pCn0EeG4PE1NDuHaJOFDA3auv5r/+Qp5CJ1bZyWW3kBPgedV62VQ+hGujiANZ3Lk95g6UZdlmrR1dYTeVD+HKFHHAyd2w+u/SdAiXS8QBXVpJMg/5DX3arLW7vZqpvGyd4lJFHOCsRuuc5reKo1yd20fffUEdPK/pVE3lc1xTXL0i6fgxsKEs02b6DH2IyJXtqg6RdjDTFsodMRAtBvq8AVJ2NP2i9z8CcZ3/6jSJXpTMJ1nSt58v+JdIR8AC1VCg21uSKdVmidk469aDQ56wUj3TeLhkxHvWCmx7jWMoez5GHi0YtfGGomTanK4XB21GENKEkhHyt2ZUP24maC120Mo08fKRZVnHMO5mLoNTvB6AwiCGnZyWs1MlegbC8mx72HqMvzuGgMSyrIPWzRwGV/RVMRQ5j2/laOpAXLi6SaEmZLb8BdZZsrzG310rVMgxEUOesq7BEXdRynG2Bjij66BrQol2o2eiVji5RqYSlGCW6UB2nesR8PjiLkpnEHCqvmM8VTJ5QeXQbzbRnyPuwoEo4QRuAv7gdPMba85o+WJxYBJ5QDPQYsxj4rH8/3OaaAf+CDAAVvn1VEy/MOwAAAAASUVORK5CYII=",verticalOrigin:w.VerticalOrigin.BASELINE}),Object(l["a"])(E,"defaultLabelStyle",{font:"28px sans-serif",fillColor:w.Color.WHITE,showBackground:!0,style:w.LabelStyle.FILL_AND_OUTLINE,verticalOrigin:w.VerticalOrigin.BOTTOM,pixelOffset:new w.Cartesian2(20,-30),heightReference:w.HeightReference.NONE});var C=function(e){Object(a["a"])(i,e);var t=f(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.defaultStyle;Object(c["a"])(this,i),n=t.call(this,e),n._type="POINT",n.gvtype=u["a"].POINT,n.positions=a.positions;var o=Object(r["a"])(n);if(n.positions instanceof w.Cartesian3)n.options={gvname:n._name,gvid:n._gvid,gvtype:n._gvtype,position:new w.CallbackProperty((function(){return o.positions}),!1),point:a};else{if(!(n.positions instanceof Array))throw new Error("options参数错误.");n.options=[];for(var s=function(e){var t={gvname:n._name,gvid:n._gvid,gvtype:n._gvtype,position:new w.CallbackProperty((function(){return o.positions[e]}),!1),point:a};n.options.push(t)},l=0;l<n.positions.length;l++)s(l)}return n.graphic=[],n.create(),n}return Object(d["a"])(i,[{key:"create",value:function(){var e=this;this.options instanceof Array?this.graphic=this.options.map((function(t){var i=e.viewer.entities.add(t);return i})):this.graphic=this.viewer.entities.add(this.options)}},{key:"remove",value:function(){var e=this;this.graphic instanceof Array?this.graphic.map((function(t){e.viewer.entities.remove(t)})):this.viewer.entities.remove(this.graphic),this.graphic=void 0}},{key:"startEdit",value:function(){var e=this;if(this.graphic instanceof w.Entity)this.graphic.position=new w.CallbackProperty((function(){return e.positions}),!1);else if(this.graphic instanceof Array)for(var t=this.graphic.length,i=function(t){e.graphic[t].position=new w.CallbackProperty((function(){return e.positions[t]}),!1)},n=0;n<t;n++)i(n)}},{key:"stopEdit",value:function(){this.graphic instanceof w.Entity?this.graphic.position=this.graphic.position.getValue():this.graphic instanceof Array&&(this.graphic=this.graphic.map((function(e){return e.position=e.position.getValue()})))}},{key:"contain",value:function(e){if(this.graphic instanceof w.Cartesian3)return this.graphic===e;if(this.graphic instanceof Array)for(var t=this.graphic.length,i=0;i<t;i++)if(this.graphic[i]===e)return i;return-1}},{key:"destroy",value:function(){this.remove(),this.viewer=void 0,this.options=void 0,this.graphic=void 0}}],[{key:"equalPosition",value:function(e,t){if(!(e instanceof w.Cartesian3&&t instanceof w.Cartesian3))throw new Error("node不是一个有效的Cartesian3对象");return e.x===t.x&&e.y===t.y&&e.z===t.z}},{key:"setStyle",value:function(e,t){for(var i=Object.keys(t),n=0,r=i;n<r.length;n++){var a=r[n];e.point[a]=t[a]}}},{key:"fromDegrees",value:function(e,t){var n=i.defaultStyle;if(t instanceof Array)n.positions=t.map((function(e){if(void 0===e.lon||void 0===e.lat)throw new Error("参数错误");return w.Cartesian3.fromDegrees(e.lon,e.lat,e.height)}));else{if(void 0===t.lon||void 0===t.lat)throw new Error("参数错误");n.positions=w.Cartesian3.fromDegrees(t.lon,t.lat,t.height)}return new i(e,n)}},{key:"fromRadians",value:function(e,t){var n=i.defaultStyle;if(t instanceof Array)n.positions=t.map((function(e){if(void 0===e.lon||void 0===e.lat)throw new Error("参数错误");return w.Cartesian3.fromRadians(e.lon,e.lat,e.height)}));else{if(void 0===t.lon||void 0===t.lat)throw new Error("参数错误");n.positions=w.Cartesian3.fromRadians(n.positions.lon,n.positions.lat,n.positions.height)}return new i(e,n)}},{key:"isCesiumPoint",value:function(e){return!(!k(e)||!e.id||e.id.gvtype!==u["a"].POINT)}}]),i}(b);Object(l["a"])(C,"defaultStyle",{color:w.Color.RED,pixelSize:5,outlineColor:w.Color.WHITE,outlineWidth:3,heightReference:w.HeightReference.CLAMP_TO_GROUND}),Object(l["a"])(C,"editStyle",{color:w.Color.RED,pixelSize:5,outlineColor:w.Color.AQUA,outlineWidth:3,heightReference:w.HeightReference.CLAMP_TO_GROUND}),Object(l["a"])(C,"selectedStyle",{color:w.Color.AQUA,pixelSize:5,outlineColor:w.Color.AQUA,outlineWidth:3});var O=function(e){Object(a["a"])(i,e);var t=f(i);function i(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.defaultStyle;Object(c["a"])(this,i),n=t.call(this,e),n._type="POLYLINE",n.gvtype=u["a"].POLYLINE,n.positions=a.positions||[];var o=Object(r["a"])(n),s=function(){return o.positions};return n.options={gvname:n._name,gvid:n._gvid,gvtype:n._gvtype,polyline:a,properties:a.properties},delete a.properties,n.options.polyline.positions=new w.CallbackProperty(s,!1),n.graphic=void 0,n.nodeGraphic=void 0,n.node=!1,n.create(),n}return Object(d["a"])(i,[{key:"material",get:function(){if(this.graphic)return this.graphic.polyline.material}},{key:"width",get:function(){if(this.graphic)return this.graphic.polyline.width.getValue()}},{key:"properties",get:function(){return!!this.graphic&&this.graphic.properties},set:function(e){if(this.graphic)return this.graphic.properties=e}},{key:"addNode",value:function(e){e instanceof w.Cartesian3&&this.positions.push(e)}},{key:"popNode",value:function(){this.positions.pop()}},{key:"updateNode",value:function(e,t){if(e<0||e>this.positions.length-1)throw new Error("无效的index");if(t instanceof w.Cartesian3===!1)throw new Error("无效的node");this.positions[e]=t}},{key:"dropNode",value:function(e){this.positions.splice(e,1)}},{key:"create",value:function(){this.viewer&&(this.graphic=this.viewer.entities.add(this.options))}},{key:"createNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.defaultStyle;e.positions=this.positions,e.clampToGround=this.options.polyline.clampToGround,this.nodeGraphic=new C(this.viewer,e),this.node=!0}},{key:"startEdit",value:function(){var e=this;k(this.graphic)&&(this.graphic.polyline.positions=new w.CallbackProperty((function(){return e.positions}),!1),!1===this.node&&this.createNode())}},{key:"stopEdit",value:function(){this.graphic instanceof w.Entity&&(this.graphic.polyline.positions=this.positions),this.removeNode()}},{key:"remove",value:function(){this.viewer&&(this.viewer.entities.remove(this.graphic),this.graphic=void 0,this.removeNode())}},{key:"removeNode",value:function(){this.node&&(this.nodeGraphic.remove(),this.node=!1)}},{key:"setMaterial",value:function(e){this.graphic.polyline.material=e}},{key:"destroy",value:function(){this.remove(),this.viewer=void 0,this.options=void 0,this.positions=void 0,this.nodeGraphic&&this.nodeGraphic.destroy(),this.nodeGraphic=void 0}}],[{key:"fromDegrees",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=t.map((function(e){return w.Cartesian3.fromDegrees(e.lon,e.lat,e.height)}));var r=m(m({positions:t},i.defaultStyle),{},{properties:n}),a=new i(e,r);return a.stopEdit(),a}},{key:"fromRadians",value:function(e,t){t=t.map((function(e){return w.Cartesian3.fromRadians(e.lon,e.lat,e.height)}));var n=m({positions:t},i.defaultStyle),r=new i(e,n);return r}}]),i}(b);Object(l["a"])(O,"defaultStyle",{clampToGround:!0,material:w.Color.fromCssColorString("rgba(247,224,32,1)"),width:3}),Object(l["a"])(O,"selectedStyle",{clampToGround:!0,material:w.Color.AQUA,width:3});var P=function(e){Object(a["a"])(i,e);var t=f(i);function i(e){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.defaultStyle;Object(c["a"])(this,i),a=t.call(this,e),a._type="POLYGON",a.gvtype=u["a"].POLYGON,a.positions=o.positions||[],a.nodePositions=Object(n["a"])(a.positions);var s=Object(r["a"])(a);return a.options={gvid:a.gvid,gvtype:a.gvtype,polygon:m({hierarchy:new w.CallbackProperty((function(){return new w.PolygonHierarchy(s.positions)}),!1)},o),properties:o.properties},delete o.properties,a.node=!1,a.graphic=void 0,a.nodeGraphic=void 0,a.outlineGraphic=void 0,a.outline=o.outline,a.create(),a}return Object(d["a"])(i,[{key:"properties",get:function(){return!!this.graphic&&this.graphic.properties},set:function(e){return!!this.graphic&&(this.graphic.properties=e)}},{key:"outlineStyle",get:function(){if(this.outlineGraphic)return this.outlineGraphic.polyline},set:function(e){var t={};if(k(this.outlineGraphic)){var i=this.outlineGraphic.graphic.polyline;t.material=e.outlineColor||i.material,t.width=e.outlineWidth||i.width,this.outlineGraphic.graphic.polyline.material=t.material,this.outlineGraphic.graphic.polyline.width=t.width,this.outlineGraphic.options.polyline.material=t.material,this.outlineGraphic.options.polyline.width=t.width}else this.outline&&this.createOutline(t)}},{key:"material",get:function(){if(this.graphic)return this.graphic.polygon.material.getValue().color}},{key:"outlineColor",get:function(){return this.outlineGraphic?this.outlineGraphic.graphic.polyline.material.getValue().color:i.defaultStyle.outlineColor}},{key:"outlineWidth",get:function(){return this.outlineGraphic?this.outlineGraphic.graphic.polyline.width.getValue():i.defaultStyle.outlineWidth}},{key:"addNode",value:function(e){if(e instanceof w.Cartesian3){this.positions.push(e);var t=this.nodePositions.length;0===t&&(this.nodePositions.push(this.positions[0]),this.nodePositions.push(this.positions[0])),t>=2&&(this.nodePositions[t]=this.nodePositions[t-1],this.nodePositions[t-1]=e)}}},{key:"updateNode",value:function(e,t){if(e<0||e>this.positions.length-1)throw new Error("无效的index");if(t instanceof w.Cartesian3===!1)throw new Error("无效的node");this.positions[e]=t,0===e?(this.nodePositions[0]=t,this.nodePositions[this.nodePositions.length-1]=t):this.nodePositions[e]=t}},{key:"popNode",value:function(){this.positions.pop(),this.nodePositions.splice(this.nodePositions.length-2),this.nodePositions.push(this.positions[0])}},{key:"dropNode",value:function(e){this.positions.splice(e,1),this.nodePositions.splice(e,1),0===e&&(this.nodePositions[this.nodePositions.length-1]=this.nodePositions[0])}},{key:"create",value:function(){this.options.polygon.outline=!1,this.viewer&&(this.graphic=this.viewer.entities.add(this.options),this.outline&&this.createOutline())}},{key:"createNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.defaultStyle;this.node=!0,e.positions=this.positions,e.clampToGround=this.graphic.polygon.perPositionHeight.getValue(),this.nodeGraphic=new C(this.viewer,e)}},{key:"createOutline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!1!==this.options.outline?(e.width=this.options.polygon.outlineWidth||O.defaultStyle.width,e.material=this.options.polygon.outlineColor||O.defaultStyle.material,e.clampToGround=!this.graphic.polygon.perPositionHeight.getValue(),e.positions=this.nodePositions,this.outlineGraphic=new O(this.viewer,e),this.outline=!0):M.log("如果您想创建多边形边线,请在options中设置outline为true")}},{key:"startEdit",value:function(){var e=this.positions;this.graphic instanceof w.Entity&&(this.graphic.polygon.hierarchy=new w.CallbackProperty((function(){return new w.PolygonHierarchy(e)})),this.outline?(this.outlineGraphic.startEdit(),this.nodeGraphic=this.outlineGraphic.nodeGraphic,this.node=!0):this.createNode())}},{key:"stopEdit",value:function(){this.graphic instanceof w.Entity&&(this.graphic.polygon.hierarchy=new w.PolygonHierarchy(this.positions)),this.removeNode(),this.nodeGraphic&&this.nodeGraphic.stopEdit(),this.outlineGraphic&&this.outlineGraphic.stopEdit()}},{key:"remove",value:function(){this.viewer&&(this.viewer.entities.remove(this.graphic),this.graphic=void 0,this.removeNode(),this.removeOutline())}},{key:"removeOutline",value:function(){this.outline&&(this.outlineGraphic.remove(),this.outline=!1,this.outlineGraphic=void 0)}},{key:"removeNode",value:function(){this.node&&(this.nodeGraphic.remove(),this.node=!1)}},{key:"destroy",value:function(){this.remove(),this.viewer=void 0,this.positions=void 0,this.options=void 0,this.nodeGraphic&&this.nodeGraphic.destroy(),this.outlineGraphic&&this.outlineGraphic.destroy(),this.outlineGraphic=void 0,this.nodeGraphic=void 0}}],[{key:"fromDegrees",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=t.map((function(e){return w.Cartesian3.fromDegrees(e.lon,e.lat,e.height)}));var r=i.defaultStyle;r.positions=t,r.properties=n;var a=new i(e,r);return a.stopEdit(),a}},{key:"fromRadians",value:function(e,t){t=t.map((function(e){return w.Cartesian3.fromRadians(e.lon,e.lat,e.height)}));var n=i.defaultStyle;return n.positions=t,new i(e,n)}}]),i}(b);Object(l["a"])(P,"defaultStyle",{material:new w.Color.fromCssColorString("rgba(247,224,32,0.5)"),outline:!0,outlineColor:new w.Color.fromCssColorString("rgba(255,247,145,1)"),outlineWidth:2,perPositionHeight:!1}),Object(l["a"])(P,"selectedStyle",{material:new w.ColorMaterialProperty(w.Color.AQUA.withAlpha(.4)),outlineColor:w.Color.AQUA.withAlpha(.4)});var x=function(e){Object(a["a"])(i,e);var t=f(i);function i(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.defaultStyle;return Object(c["a"])(this,i),n=t.call(this,e),n._type="LABEL",n._gvtype=u["a"].LABEL,n.position=r.position,n.options={gvid:n._gvid,gvtype:n._gvtype,position:n.position,label:r},n.graphic=void 0,n.create(),n}return Object(d["a"])(i,[{key:"color",get:function(){if(this.graphic)return this.graphic.label.fillColor.getValue()},set:function(e){this.graphic&&(this.graphic.label.fillColor=e)}},{key:"font",get:function(){if(this.graphic)return this.graphic.label.font.getValue()}},{key:"create",value:function(){this.graphic=this.viewer.entities.add(this.options)}},{key:"startEdit",value:function(){var e=this;this.graphic&&(this.graphic.label.position=new w.CallbackProperty((function(){return e.position}),!1))}},{key:"stopEdit",value:function(){this.graphic&&(this.graphic.label.position=this.position)}},{key:"remove",value:function(){this.viewer&&this.viewer.entities.remove(this.graphic),this.graphic=void 0}},{key:"updateText",value:function(e){this.graphic&&(this.graphic.label.text=e,this.gvname=e)}},{key:"destroy",value:function(){this.remove(),this.viewer=void 0,this.options=void 0,this.positions=void 0}}]),i}(b);Object(l["a"])(x,"defaultStyle",{color:w.Color.WHITE,font:"28px sans-serif",showBackground:!0});var L=function(e){Object(a["a"])(i,e);var t=f(i);function i(e,n){var r;return Object(c["a"])(this,i),r=t.call(this,e),r._type="MODEL",r._gvtype=u["a"].MODEL,r.position=n.position,r.options={gvid:r._gvid,gvtype:r._gvtype,position:r.position,model:n},r.create(),r}return Object(d["a"])(i,[{key:"create",value:function(){this.graphic=this.viewer.entities.add(this.options)}},{key:"startEdit",value:function(){var e=this;this.graphic&&(this.graphic.label.position=new w.CallbackProperty((function(){return e.position}),!1))}},{key:"stopEdit",value:function(){this.graphic&&(this.graphic.label.position=this.position)}},{key:"remove",value:function(){this.viewer&&(this.viewer.entities.remove(this.graphic),this.graphic=void 0)}},{key:"destroy",value:function(){this.remove(),this.options=void 0,this.position=void 0}},{key:"uri",set:function(e){this.graphic&&(this.graphic.model.uri=e)}},{key:"color",set:function(e){this.graphic&&(this.graphic.model.color=e)}},{key:"mode",set:function(e){this.graphic&&(this.graphic.model.colorBlendMode=e)}},{key:"mixed",set:function(e){this.graphic&&(this.graphic.model.colorBlendAmount=e)}}]),i}(b);Object(l["a"])(L,"defaultStyle",{colorBlendMode:w.ColorBlendMode.HIGHLIGHT,color:w.Color.WHITE,colorBlendAmount:.5,minimumPixelSize:64})},cd56:function(e,t,i){"use strict";i("0bbc")},dec1:function(e,t,i){"use strict";i("b3f0")},ea24:function(e,t,i){"use strict";i("5727")},fe26:function(e,t,i){}});